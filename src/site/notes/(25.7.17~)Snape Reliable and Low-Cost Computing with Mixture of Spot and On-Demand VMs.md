---
{"dg-publish":true,"permalink":"/25-7-17-snape-reliable-and-low-cost-computing-with-mixture-of-spot-and-on-demand-v-ms/"}
---

**ë…¼ë¬¸ ì œëª©:** Snape Reliable and Low-Cost Computing with Mixture of Spot and On-Demand VMs
**ì‹œì‘ ì‹œê°„:** 2025-07-17

**å•è¯:**
	Reliable å¯ä¿¡èµ–çš„ï¼›å¯é çš„
	Cost æˆæœ¬
	Mixture æ··åˆçš„
	Demand éœ€æ±‚ï¼Œéœ€è¦ï¼Œ On-Demand æŒ‰éœ€ä½¿ç”¨

**è¯­æ³•:**
	â€œwith + åè¯â€ ç»“æ„çš„å‡ ç§å¸¸è§ç”¨æ³•ï¼š
		è¡¨ç¤ºå·¥å…· / æ‰‹æ®µ / æ–¹å¼ï¼ˆæœ€å¸¸è§ï¼‰
		- Cut the paper with scissors.ï¼ˆç”¨å‰ªåˆ€å‰ªçº¸ï¼‰
		- Computing with a mixture of VM typesï¼ˆä½¿ç”¨å¤šç§ VM ç±»å‹è¿›è¡Œè®¡ç®—ï¼‰
		
		è¡¨ç¤ºä¼´éšã€æºå¸¦
		- He came with his friends.ï¼ˆä»–å’Œæœ‹å‹ä¸€èµ·æ¥çš„ï¼‰
		
		è¡¨ç¤ºç‰¹å¾ / çŠ¶æ€
		- A box with a red ribbonï¼ˆä¸€ä¸ªæœ‰çº¢è‰²ä¸å¸¦çš„ç›’å­ï¼‰
		
		å¼•å¯¼ä¼´éšçŠ¶è¯­ï¼ˆæ›´å¤æ‚çš„ç»“æ„ï¼‰
		- With everyone watching, she began to sing.ï¼ˆåœ¨å¤§å®¶éƒ½æ³¨è§†çš„æƒ…ä¸‹ï¼Œå¥¹å¼€å§‹å”±æ­Œï¼‰

**ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ byï¼Ÿ**

| **ä»‹è¯**   | **ç”¨é€”**                      | **ä¸¾ä¾‹**                                                                                          |
| -------- | --------------------------- | ----------------------------------------------------------------------------------------------- |
| **with** | è¡¨ç¤ºå·¥å…·ã€æ‰‹æ®µã€èº«ä½“éƒ¨ä½ç­‰ï¼ˆå¼ºè°ƒâ€œç”¨ä»€ä¹ˆä¸œè¥¿åšæŸäº‹â€ï¼‰ | - Cut with scissors- Hit with a stick- Write with a pen                                         |
| **by**   | è¡¨ç¤ºæ‰§è¡Œè€…ã€é€”å¾„ã€æ–¹å¼ï¼ˆå¼ºè°ƒâ€œé€šè¿‡è°/æ€ä¹ˆåšâ€ï¼‰    | - A book **by** Hemingwayï¼ˆè°å†™çš„ï¼‰- Travel **by** trainï¼ˆé€šè¿‡ä»€ä¹ˆæ–¹å¼ï¼‰- The cake was made **by** herï¼ˆè¢«è°åšçš„ï¼‰ |

---
**ABSTRACT æ¦‚è¦**

Cloud providers often have resources that are not being fully utilized, 
**å•è¯ï¼š**
	often æ—¶å¸¸ï¼ˆ60%):
	always æ€»æ˜¯ï¼Œä¸€ç›´ï¼ˆ100%ï¼‰
	usually é€šå¸¸(80%)
	frequently é¢‘ç¹çš„(70%)
	
	utilized åˆ©ç”¨

**è¯­æ³•ï¼š**

**beï¼ˆis/areï¼‰+ being + è¿‡å»åˆ†è¯ï¼ˆutilizedï¼‰**

	ä¾‹å¥ï¼šThe system is being updated.ï¼ˆç³»ç»Ÿæ­£åœ¨è¢«æ›´æ–°ã€‚ï¼‰

	ä¸»åŠ¨å¥ï¼ˆä¸»åŠ¨è¿›è¡Œï¼‰They are using the server.ï¼ˆä»–ä»¬æ­£åœ¨ä½¿ç”¨æœåŠ¡å™¨ï¼‰
	
	è¢«åŠ¨å¥ï¼ˆè¢«åŠ¨è¿›è¡Œï¼‰The server is being used.ï¼ˆæœåŠ¡å™¨æ­£åœ¨è¢«ä½¿ç”¨ï¼‰

**that å¼•å¯¼å®šè¯­ä»å¥ï¼šä¿®é¥°å‰é¢çš„åè¯ã€‚**

	ä¾‹å¥ï¼šI saw a movie that made me cry.ï¼ˆæˆ‘çœ‹äº†ä¸€éƒ¨è®©æˆ‘å“­çš„ç”µå½±ã€‚ï¼‰

https://www.youtube.com/watch?v=bIAFcgs59Ys&list=PLzraVIBodoVCGBnDE-qGPvl9usAaUcvEo&index=2

![Pasted image 20250717233652.png](/img/user/Pasted%20image%2020250717233652.png)
![Pasted image 20250717233656.png](/img/user/Pasted%20image%2020250717233656.png)
![Pasted image 20250717234002.png](/img/user/Pasted%20image%2020250717234002.png)

![Pasted image 20250717234914.png](/img/user/Pasted%20image%2020250717234914.png)
âœ… ç”¨ç°åœ¨è¿›è¡Œæ—¶ï¼ˆä½ ç°åœ¨è¿™æ ·å†™çš„ï¼‰ï¼š
The people that are working in the office are very friendly.
å¼ºè°ƒâ€œæ­£åœ¨å·¥ä½œä¸­çš„é‚£äº›äººâ€ã€‚

âœ… ç”¨ä¸€èˆ¬ç°åœ¨æ—¶ï¼ˆæ›´å¸¸è§ï¼‰ï¼š
The people who work in the office are very friendly.
= åœ¨åŠå…¬å®¤å·¥ä½œçš„äººï¼ˆä¸æ˜¯å¼ºè°ƒâ€œæ­¤æ—¶æ­¤åˆ»â€ï¼Œè€Œæ˜¯â€œå¹³æ—¶/é€šå¸¸â€çš„æƒ…å†µï¼‰

**ä½ çš„å¥å­ï¼š**
âŒ The woman who live in downstairs is a docter

âœ… æ­£ç¡®å¥å­ï¼š
The woman who lives downstairs is a doctor.

| åŸå¥éƒ¨åˆ†              | é—®é¢˜       | æ­£ç¡®å†™æ³•             | è¯´æ˜                                      |
| ----------------- | -------- | ---------------- | --------------------------------------- |
| **who live**      | âŒ åŠ¨è¯å½¢å¼é”™è¯¯ | âœ… **who lives**  | ä¸»è¯­æ˜¯ **the woman**ï¼ˆå•æ•°ï¼‰ï¼ŒåŠ¨è¯ä¹Ÿè¦ç”¨å•æ•°ï¼š**lives** |
| **in downstairs** | âŒ ä»‹è¯å¤šä½™   | âœ… **downstairs** | **downstairs** æœ¬èº«å°±æ˜¯å‰¯è¯ï¼Œä¸èƒ½å†åŠ  **in**       |
| **docter**        | âŒ æ‹¼å†™é”™è¯¯   | âœ… **doctor**     | æ­£ç¡®æ‹¼å†™æ˜¯ **doctor**                        |

æˆ‘è¦å«ä¸€ä¸ªæˆ‘çˆ±çš„äººã€‚
I want to marry with the people who loves me


### âœ… æ¨èæ”¹æ³•ï¼ˆè¯´â€œä¸€ä¸ªäººâ€ï¼‰ï¼š
> **I want to marry the person who loves me.**

I want to marry with the people who is my love
### âœ… æ›´è‡ªç„¶çš„æ”¹æ³•ï¼š
**I want to marry the person who I love.**  
ğŸ‘‰ï¼ˆæˆ‘æƒ³å«ç»™æˆ‘çˆ±çš„äººï¼‰
 **I want to marry someone I love and who loves me.**  ğŸ‘‰ï¼ˆæˆ‘æƒ³å«ç»™æˆ‘çˆ±çš„äººï¼Œä¹Ÿçˆ±æˆ‘çš„äººï¼‰


---
and they may **offer** them at a lower cost to make up for the reduced availability of these resources.
ä¸ºäº†å¼¥è¡¥è¿™äº›èµ„æºå¯ç”¨æ€§é™ä½çš„æƒ…å†µï¼Œä»–ä»¬å¯èƒ½ä¼šä»¥æ›´ä½çš„æˆæœ¬**æä¾›**è¿™äº›èµ„æºã€‚

å•è¯ï¼ŒçŸ­è¯­ï¼š

| å•è¯/çŸ­è¯­                        | ä¸­æ–‡æ„æ€    | è¯­æ³•è§’è‰²     | è¯´æ˜                 |
| ---------------------------- | ------- | -------- | ------------------ |
| **may offer**                | å¯èƒ½æä¾›    | åŠ©åŠ¨è¯ + åŠ¨è¯ | è¡¨ç¤ºå¯èƒ½æ€§              |
| **them**                     | å®ƒä»¬ï¼ˆæŒ‡èµ„æºï¼‰ | ä»£è¯       | æŒ‡ä¸Šæ–‡æåˆ°çš„â€œresourcesâ€  |
| **at a lower cost**          | ä»¥è¾ƒä½çš„æˆæœ¬  | ä»‹è¯çŸ­è¯­     | è¡¨ç¤ºæä¾›çš„â€œä»·æ ¼â€è¾ƒä½        |
| **to make up for**           | å¼¥è¡¥ã€è¡¥å¿   | åŠ¨è¯çŸ­è¯­     | è¡¨ç¤ºâ€œä¸ºäº†è¡¥å¿â€¦â€¦â€         |
| **reduced**                  | é™ä½çš„     | åŠ¨è¯       |                    |
| **the reduced availability** | é™ä½çš„å¯ç”¨æ€§  | åè¯çŸ­è¯­     | æŒ‡è¿™äº›èµ„æºæ²¡é‚£ä¹ˆå®¹æ˜“æ‹¿åˆ°äº†      |
| **of these resources**       | è¿™äº›èµ„æºçš„   | ä»‹è¯çŸ­è¯­     | ä¿®é¥°å‰é¢çš„ availability |
**åŒ…å«äº† ä»‹è¯çŸ­è¯­ä¿®é¥°ï¼ŒåŠŸèƒ½å’Œå®šè¯­ä»å¥å¾ˆåƒ**

çœ‹çœ‹è¿™ä¸ªç»“æ„ï¼š

the reduced availability of these resources

availability = å¯ç”¨æ€§ï¼ˆåè¯ï¼‰

of these resources = ä¿®é¥° availabilityï¼Œè¡¨ç¤ºâ€œè¿™äº›èµ„æºçš„å¯ç”¨æ€§â€

**è¿™å°±åƒæ˜¯å®šè¯­ä»å¥ï¼š**

the availability that these resources have
ï¼ˆè¿™äº›èµ„æºæ‹¥æœ‰çš„å¯ç”¨æ€§ï¼‰

ä½†è‹±è¯­é‡Œ**æ›´å¸¸ç”¨ åè¯ + ä»‹è¯çŸ­è¯­ çš„ç»“æ„**æ¥è¡¨è¾¾è¿™ä¸ªæ„æ€ã€‚
æ¯”å¦‚ï¼š

|ç±»å‹|ç»“æ„|åŠŸèƒ½|æ˜¯å¦æ˜¯å®šè¯­ä»å¥|
|---|---|---|---|
|**ä»‹è¯çŸ­è¯­**|at a lower cost|ä¿®é¥°æ•´ä¸ªâ€œofferâ€çš„æ–¹å¼|âŒ ä¸æ˜¯å®šè¯­ä»å¥ï¼Œä½†åŠŸèƒ½ç±»ä¼¼|
|**å®šè¯­ä»å¥**|that cost less|ä¿®é¥°â€œthemâ€è¿™ä¸ªåè¯|âœ… æ˜¯å®šè¯­ä»å¥|

| âœ… åœ°é“è¡¨è¾¾ï¼ˆä»‹è¯çŸ­è¯­ï¼‰              | âŒ ä½æ•ˆè¡¨è¾¾ï¼ˆå†—é•¿å®šè¯­ä»å¥ï¼‰                  |
| ------------------------- | ------------------------------- |
| the price **of the item** | the price **that the item has** |
| live **in the city**      | the city **which they live in** |

**and they may offer these resources at a lower cost to make up for the reduced availability of them. ä¸æ˜¯æ›´åˆé€‚å—**

###### ChatGPT è¯´ï¼š
ä½ çš„å¥å­è¯­æ³•ä¸Šæ˜¯**æ­£ç¡®çš„**ï¼Œä½†åœ¨**åœ°é“çš„è‹±è¯­è¡¨è¾¾ä¸­**ï¼Œç»“å°¾çš„ **â€œof themâ€** å®é™…ä¸Šæ˜¯ **ä¸å¤ªè‡ªç„¶çš„**ã€‚æ›´è‡ªç„¶çš„è¡¨è¾¾åº”è¯¥æ˜¯ï¼š

> âœ… **...to make up for the reduced availability _of these resources_.**

ä¸ºä»€ä¹ˆ â€œof themâ€ ä¸å¦‚ â€œof these resourcesâ€ æ›´åˆé€‚ï¼Ÿ

**1."of them" æ˜¯ä»£è¯ + ä»‹è¯ç»“æ„**ï¼Œä½†åœ¨è‹±è¯­ä¸­ï¼š
- å½“å…ˆå‰çš„åè¯è·ç¦»è¾ƒè¿œã€æˆ–æƒ³è®©å¥å­æ›´æ¸…æ¥šã€å¼ºè°ƒæ„æ€æ—¶ï¼Œ
- **ç›´æ¥é‡å¤é‚£ä¸ªåè¯**ï¼ˆå“ªæ€•ä¹‹å‰å·²ç»å‡ºç°ï¼‰åè€Œæ›´æ¸…æ™°è‡ªç„¶ã€‚
âœ… ä¸¾ä¾‹ï¼š

> There is a shortage of nurses.  
> Hospitals are increasing wages **to make up for the lack of nurses**.  
> âŒ Not: _to make up for the lack of them_.

**2.ä»£è¯ "them" åœ¨ of åé¢å®¹æ˜“æ¨¡ç³Šæ„æ€**
ç‰¹åˆ«æ˜¯åœ¨è¡¨è¾¾â€œ...çš„å¯ç”¨æ€§â€æ—¶ï¼š
- **availability of them** â† ä¸æ¸…æ™°ï¼Œâ€œä»–ä»¬çš„å¯ç”¨æ€§â€è¿˜æ˜¯â€œå®ƒä»¬çš„â€ï¼Ÿ
- è€Œ **availability of these resources** â† æ˜ç¡®ï¼Œå°±æ˜¯â€œè¿™äº›èµ„æºçš„å¯ç”¨æ€§â€ã€‚

**æ‰€ä»¥æœ€åœ°é“çš„å¥å­ç‰ˆæœ¬æ˜¯ï¼š**

> **...and they may offer these resources at a lower cost to make up for the reduced availability of these resources.**

ä½†è¿™åˆç¨å¾®æœ‰ç‚¹**é‡å¤**ï¼Œæ‰€ä»¥æœ€è‡ªç„¶çš„å†™æ³•é€šå¸¸æ˜¯ï¼š

> âœ… **...and they may offer them at a lower cost to make up for the reduced availability of these resources.**


åˆ†è¯ä½œå®šè¯­æ˜¯è‹±è¯­ä¸­å¾ˆå¸¸è§çš„è¯­æ³•ç»“æ„ï¼š

| ç»“æ„              | ä¸¾ä¾‹                   | ä¸­æ–‡æ„æ€    |
| --------------- | -------------------- | ------- |
| âœ… **è¿‡å»åˆ†è¯ + åè¯** | reduced availability | è¢«å‡å°‘çš„å¯ç”¨æ€§ |
|                 | written report       | å†™å¥½çš„æŠ¥å‘Š   |
|                 | broken window        | è¢«æ‰“ç ´çš„çª—æˆ·  |
| âœ… **ç°åœ¨åˆ†è¯ + åè¯** | running water        | æµåŠ¨çš„æ°´    |
|                 | falling leaves       | æ‰è½çš„æ ‘å¶   |

However, customers may be hesitant to use such offerings (such as spot VMs) as making trade-offs between cost and resource availability is not always straightforward.
ç„¶è€Œï¼Œå®¢æˆ·å¯èƒ½ä¼šå¯¹ä½¿ç”¨æ­¤ç±»äº§å“ï¼ˆä¾‹å¦‚ spot è™šæ‹Ÿæœºï¼‰æ„Ÿåˆ°çŠ¹è±«ï¼Œå› ä¸ºåœ¨æˆæœ¬å’Œèµ„æºå¯ç”¨æ€§ä¹‹é—´åšå‡ºæƒè¡¡å¹¶ä¸æ€»æ˜¯é‚£ä¹ˆå®¹æ˜“ã€‚

å•è¯ï¼š

| è¯è¯­ / çŸ­è¯­                                    | ç±»å‹    | å«ä¹‰                                    |
| ------------------------------------------ | ----- | ------------------------------------- |
| **However**                                | è¿è¯    | ç„¶è€Œï¼ˆè¡¨ç¤ºè½¬æŠ˜ï¼‰                              |
| **customers**                              | åè¯    | å®¢æˆ·ï¼Œç”¨æˆ·ï¼ˆæŒ‡ä½¿ç”¨æœåŠ¡çš„äººï¼‰                        |
| **hesitant**                               | å½¢å®¹è¯   | çŠ¹è±«çš„ã€è¿Ÿç–‘çš„ã€ä¸å¤ªæ„¿æ„çš„                         |
| **such offerings**                         | åè¯çŸ­è¯­  | æ­¤ç±»æœåŠ¡/äº§å“ï¼ˆæ³›æŒ‡åƒ spot VMs è¿™æ ·çš„äº‘äº§å“ï¼‰          |
| **(such as spot VMs)**                     | æ’å…¥è¯´æ˜  | æ¯”å¦‚ spot è™šæ‹Ÿæœºï¼ˆæ‰“æ¯”æ–¹è¯´æ˜â€œsuch offeringsâ€æŒ‡ä»€ä¹ˆï¼‰ |
| **as**                                     | è¿è¯    | å› ä¸ºã€ç”±äºï¼ˆåœ¨è¿™é‡Œå¼•å¯¼åŸå› ä»å¥ï¼‰                      |
| **making trade-offs**                      | åŠ¨åè¯çŸ­è¯­ | åšå‡ºå–èˆã€æƒè¡¡ï¼ˆæŒ‡åœ¨ä¸¤ä¸ªç›®æ ‡ä¹‹é—´åšå‡ºé€‰æ‹©ï¼‰                 |
| **between cost and resource availability** | ä»‹è¯çŸ­è¯­  | åœ¨æˆæœ¬ä¸èµ„æºå¯ç”¨æ€§ä¹‹é—´ï¼ˆçš„å–èˆï¼‰                      |
| **is not always straightforward**          | è°“è¯­ç»“æ„  | å¹¶ä¸æ€»æ˜¯ç®€å•çš„ / æ˜ç¡®çš„ï¼ˆæœ‰æ—¶å¾ˆå¤æ‚ï¼‰                  |

In this work, we propose Snape (Spot On-demand Perfect Mixture), an intelligent framework to optimize the cost and resource availability by dynamically mixing on-demand VMs with spot VMs.
åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº† **Snape**ï¼ˆå…¨ç§°ä¸º Spot On-demand Perfect Mixtureï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªæ™ºèƒ½æ¡†æ¶ï¼Œæ—¨åœ¨é€šè¿‡åŠ¨æ€åœ°æ··åˆæŒ‰éœ€è™šæ‹Ÿæœºå’ŒæŠ¢å å¼è™šæ‹Ÿæœºæ¥ä¼˜åŒ–æˆæœ¬ä¸èµ„æºå¯ç”¨æ€§ã€‚


å•è¯ï¼š

| æˆåˆ†                      | å•è¯/çŸ­è¯­                                             | è¯æ€§/ç»“æ„         | ä¸­æ–‡å«ä¹‰                                 |
| ----------------------- | ------------------------------------------------- | ------------- | ------------------------------------ |
| è°“è¯­åŠ¨è¯                    | propose                                           | åŠ¨è¯            | æå‡ºã€æå‡ºå»ºè®®                              |
| å®¾è¯­                      | Snape                                             | ä¸“æœ‰åè¯          | ç³»ç»Ÿåç§°ï¼ˆSpot/On-demand Perfect Mixtureï¼‰ |
| è§£é‡Šè¯´æ˜                    | (Spot On-demand Perfect Mixture)                  | åè¯çŸ­è¯­          | Snape çš„å…¨ç§°                            |
| â†³ Mixture               | åè¯                                                | æ··åˆä½“           |                                      |
| åŒä½è¯­çŸ­è¯­                   | an intelligent framework                          | å† è¯ + å½¢å®¹è¯ + åè¯ | ä¸€ä¸ªæ™ºèƒ½æ¡†æ¶ï¼ˆè¿›ä¸€æ­¥å®šä¹‰ Snapeï¼‰                  |
| ä¸å®šå¼ï¼ˆç›®çš„ï¼‰                 | to optimize the cost and resource availability    | åŠ¨è¯ä¸å®šå¼         | ä¸ºäº†ä¼˜åŒ–æˆæœ¬å’Œèµ„æºå¯ç”¨æ€§                         |
| â†³ to optimize           | ä¸å®šå¼åŠ¨è¯                                             | ä¼˜åŒ–            |                                      |
| â†³ the cost              | åè¯çŸ­è¯­                                              | æˆæœ¬            |                                      |
| â†³ resource availability | åè¯çŸ­è¯­                                              | èµ„æºå¯ç”¨æ€§         |                                      |
| ä»‹è¯çŸ­è¯­ï¼ˆæ–¹å¼ï¼‰                | by dynamically mixing on-demand VMs with spot VMs | ä»‹è¯ + åŠ¨åè¯ç»“æ„    | é€šè¿‡åŠ¨æ€æ··åˆ on-demand ä¸ spot å®ä¾‹çš„æ–¹å¼        |
| â†³ dynamically           | å‰¯è¯                                                | åŠ¨æ€åœ°ã€å®æ—¶åœ°       |                                      |


Through a detailed characterization based on real production traces, we verify that the eviction of spot VMs is predictable to some extent.
åŸºäºçœŸå®ç”Ÿäº§ç¯å¢ƒçš„è¿è¡Œè½¨è¿¹è¿›è¡Œè¯¦ç»†ç‰¹æ€§åˆ†æåï¼Œæˆ‘ä»¬éªŒè¯äº† spot è™šæ‹Ÿæœºçš„é©±é€åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯å¯é¢„æµ‹çš„ã€‚

| æˆåˆ†                                | å•è¯/çŸ­è¯­                                                               | è¯æ€§/ç»“æ„         | ä¸­æ–‡å«ä¹‰               |
| --------------------------------- | ------------------------------------------------------------------- | ------------- | ------------------ |
| ä»‹è¯çŸ­è¯­                              | Through a detailed characterization based on real production traces | ä»‹è¯ç»“æ„          | é€šè¿‡åŸºäºçœŸå®ç”Ÿäº§è½¨è¿¹çš„è¯¦ç»†åˆ†æ    |
| â†³ Through                         | ä»‹è¯                                                                  | é€šè¿‡ã€å€ŸåŠ©äº        |                    |
| â†³ a detailed characterization     | åè¯çŸ­è¯­                                                                | ä¸€é¡¹è¯¦ç»†çš„åˆ†æ       |                    |
| â†³ characterization                | åè¯                                                                  | ç‰¹æ€§åˆ†æã€ç‰¹å¾æè¿°     |                    |
| â†³ based on real production traces | è¿‡å»åˆ†è¯çŸ­è¯­ä½œå®šè¯­                                                           | åŸºäºçœŸå®ç”Ÿäº§è½¨è¿¹çš„     |                    |
| â†³ production traces               | åè¯çŸ­è¯­                                                                | ç”Ÿäº§è½¨è¿¹ã€è¿è¡Œæ—¥å¿—     |                    |
| å®¾è¯­ä»å¥å¼•å¯¼è¯                           | that                                                                | è¿è¯            | å¼•å¯¼å®¾è¯­ä»å¥             |
| å®¾è¯­ä»å¥ä¸»è¯­                            | the eviction of spot VMs                                            | åè¯çŸ­è¯­          | æŠ¢å å¼è™šæ‹Ÿæœºçš„é©±é€ï¼ˆè¢«ç³»ç»Ÿå¼ºåˆ¶é‡Šæ”¾ï¼‰ |
| â†³ eviction                        | åè¯                                                                  | é©±é€ã€å›æ”¶         |                    |
| â†³ of spot VMs                     | ä»‹è¯çŸ­è¯­                                                                | æŠ¢å å¼è™šæ‹Ÿæœºçš„ï¼ˆæ‰€æœ‰å…³ç³»ï¼‰ |                    |
| è°“è¯­                                | is predictable                                                      | ç³»åŠ¨è¯ + å½¢å®¹è¯     | æ˜¯å¯é¢„æµ‹çš„              |
| çŠ¶è¯­                                | to some extent                                                      | å‰¯è¯çŸ­è¯­          | åœ¨æŸç§ç¨‹åº¦ä¸Š             |


âœ… è¿™ä¸ªçŸ­è¯­ **æ²¡æœ‰ç”¨å®šè¯­ä»å¥**ï¼Œè€Œæ˜¯ç”¨äº† **è¿‡å»åˆ†è¯çŸ­è¯­ï¼ˆéè°“è¯­åŠ¨è¯ï¼‰ä½œå®šè¯­**ï¼Œä¿®é¥°åè¯ "characterization"ã€‚è¯­ä¹‰ç­‰ä»·äºå®šè¯­ä»å¥çš„ç®€åŒ–å½¢å¼ã€‚


|åŸå¥|ç±»å‹|
|---|---|
|a characterization **that is based on real production traces**|âœ… å®šè¯­ä»å¥|
|a characterization **based on real production traces**|âŒ ä¸æ˜¯å®šè¯­ä»å¥ï¼Œè€Œæ˜¯åˆ†è¯çŸ­è¯­|

Snape also leverages constrained reinforcement learning to adjust the mixture policy online. 
Snape è¿˜åˆ©ç”¨äº†å—é™å¼ºåŒ–å­¦ä¹ ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´èµ„æºæ··åˆç­–ç•¥ã€‚

| æˆåˆ†         | å•è¯/çŸ­è¯­                              | è¯æ€§   | ä¸­æ–‡å«ä¹‰                           |
| ---------- | ---------------------------------- | ---- | ------------------------------ |
| ä¸»è¯­         | Snape                              | ä¸“æœ‰åè¯ | ç³»ç»Ÿåç§°ï¼ˆSpot/On-demand çš„æ··åˆè°ƒåº¦æ¡†æ¶ï¼‰   |
| è°“è¯­åŠ¨è¯       | leverages                          | åŠ¨è¯   | åˆ©ç”¨ã€è¿ç”¨ï¼ˆæ¯” use æ›´å¼ºè°ƒç­–ç•¥æ€§ï¼‰            |
| å®¾è¯­çŸ­è¯­ï¼ˆæŠ€æœ¯æ–¹æ³•ï¼‰ | constrained reinforcement learning | åè¯çŸ­è¯­ | å—é™å¼ºåŒ–å­¦ä¹                          |
| â†³ å­æˆåˆ†      | constrained                        | å½¢å®¹è¯  | å—é™åˆ¶çš„ã€å¸¦çº¦æŸçš„                      |
| â†³ å­æˆåˆ†      | reinforcement                      | åè¯   | å¼ºåŒ–ï¼ˆç”¨äºæŒ‡ reinforcement learningï¼‰ |
| â†³ å­æˆåˆ†      | learning                           | åè¯   | å­¦ä¹ ï¼ˆæœºå™¨å­¦ä¹ ä¸­çš„â€œå­¦ä¹ â€ï¼‰                 |
| ä¸å®šå¼ï¼ˆç›®çš„ï¼‰    | to adjust                          | ä¸å®šå¼  | ä¸ºäº†è°ƒæ•´                           |
| â†³ å­æˆåˆ†      | adjust                             | åŠ¨è¯   | è°ƒæ•´ã€è°ƒèŠ‚                          |
| å®¾è¯­ï¼ˆç­–ç•¥å¯¹è±¡ï¼‰   | the mixture policy                 | åè¯çŸ­è¯­ | æ··åˆç­–ç•¥                           |
| â†³ å­æˆåˆ†      | mixture                            | åè¯   | æ··åˆã€ç»„åˆ                          |
| â†³ å­æˆåˆ†      | policy                             | åè¯   | ç­–ç•¥ã€æ–¹é’ˆ                          |
| çŠ¶è¯­ï¼ˆæ–¹å¼ï¼‰     | online                             | å‰¯è¯   | åœ¨çº¿åœ°ã€å®æ—¶åœ°                        |

Experiments across different configurations show that Snape achieves 44% savings compared to using only on-demand VMs while maintaining 99.96% availability, which is 2.77% higher than using only spot VMs.
åœ¨å¤šç§é…ç½®ä¸‹çš„å®éªŒè¡¨æ˜ï¼ŒSnape ç›¸æ¯”ä»…ä½¿ç”¨æŒ‰éœ€ VM å¯èŠ‚çœ 44% æˆæœ¬ï¼ŒåŒæ—¶ç»´æŒ 99.96% çš„å¯ç”¨æ€§ï¼Œè¿™æ¯”ä»…ä½¿ç”¨ spot VM é«˜å‡º 2.77%ã€‚

| æˆåˆ†                         | å•è¯/çŸ­è¯­                                          | è¯æ€§         | ä¸­æ–‡å«ä¹‰               |
| -------------------------- | ---------------------------------------------- | ---------- | ------------------ |
| ä¸»è¯­                         | experiments                                    | åè¯         | å®éªŒ                 |
| ä»‹è¯çŸ­è¯­ï¼ˆä¿®é¥°ä¸»è¯­ï¼‰                 | across different configurations                | ä»‹è¯çŸ­è¯­       | åœ¨ä¸åŒé…ç½®ä¸‹             |
| â†³ across                   | ä»‹è¯                                             | è·¨è¶Šã€åœ¨â€¦â€¦ä¸­    |                    |
| â†³ configurations           | åè¯                                             | é…ç½®ã€è®¾å®š      |                    |
| å®¾è¯­ä»å¥                       | that Snape achieves 44% savings...             | ä»å¥         | è¡¨æ˜çš„å†…å®¹              |
| â†³ achieves                 | åŠ¨è¯                                             | å®ç°ã€è·å¾—      |                    |
| â†³ 44% savings              | åè¯çŸ­è¯­                                           | 44% çš„æˆæœ¬èŠ‚çœ  |                    |
| æ¯”è¾ƒçŠ¶è¯­                       | compared to using only on-demand VMs           | ä»‹è¯çŸ­è¯­       | ä¸ä»…ä½¿ç”¨æŒ‰éœ€ VM ç›¸æ¯”       |
| â†³ compared to              | ä»‹è¯çŸ­è¯­                                           | ä¸â€¦â€¦æ¯”è¾ƒ      |                    |
| â†³ using only on-demand VMs | åŠ¨åè¯çŸ­è¯­                                          | åªä½¿ç”¨æŒ‰éœ€è™šæ‹Ÿæœº   |                    |
| â†³ using                    | åŠ¨åè¯                                            | ä½¿ç”¨         |                    |
| åŒæ—¶çŠ¶è¯­                       | while maintaining 99.96% availability          | è¿è¯ + åŠ¨åè¯ç»“æ„ | åŒæ—¶ä¿æŒ 99.96% çš„å¯ç”¨æ€§   |
| â†³ maintaining              | åŠ¨åè¯                                            | ç»´æŒã€ä¿æŒ      |                    |
| â†³ availability             | åè¯                                             | å¯ç”¨æ€§        |                    |
| å®šè¯­ä»å¥                       | which is 2.77% higher than using only spot VMs | å®šè¯­ä»å¥       | ä¿®é¥°ä¸Šæ–‡â€œavailabilityâ€ |
| â†³ 2.77% higher than...     | æ¯”è¾ƒç»“æ„                                           | é«˜å‡º 2.77%   |                    |
| â†³ using only spot VMs      | åŠ¨åè¯çŸ­è¯­                                          | åªä½¿ç”¨æŠ¢å å¼è™šæ‹Ÿæœº  |                    |

---
**1 INTRODUCTION**
Large cloud providers typically ensure that their services are always available and reliable by allocating a sufficient amount of computing resources, so that it appears to customers that resources are never in short supply.
å¤§å‹äº‘æœåŠ¡æä¾›å•†é€šå¸¸ä¼šé€šè¿‡åˆ†é…è¶³å¤Ÿçš„è®¡ç®—èµ„æºï¼Œæ¥ç¡®ä¿å…¶æœåŠ¡å§‹ç»ˆå¯ç”¨ä¸”å¯é ï¼Œä»è€Œè®©å®¢æˆ·æ„Ÿè§‰èµ„æºä»æœªçŸ­ç¼ºã€‚

| æˆåˆ†                       | å•è¯/çŸ­è¯­                                                    | è¯æ€§/ç»“æ„        | ä¸­æ–‡å«ä¹‰            |
| ------------------------ | -------------------------------------------------------- | ------------ | --------------- |
| å‰¯è¯                       | typically                                                | å‰¯è¯           | é€šå¸¸ï¼Œå…¸å‹åœ°          |
| è°“è¯­                       | ensure                                                   | åŠ¨è¯           | ç¡®ä¿              |
| å®¾è¯­ä»å¥å¼•å¯¼è¯                  | that                                                     | è¿è¯           | å¼•å¯¼å®¾è¯­ä»å¥          |
| å®¾è¯­ä»å¥ä¸»è¯­                   | their services                                           | åè¯çŸ­è¯­         | ä»–ä»¬çš„æœåŠ¡           |
| â†³ their                  | ä»£è¯                                                       | ä»–ä»¬çš„          |                 |
| â†³ services               | åè¯                                                       | æœåŠ¡           |                 |
| å®¾è¯­ä»å¥è°“è¯­                   | are available and reliable                               | ç³»åŠ¨è¯ + å½¢å®¹è¯å¹¶åˆ—  | æ˜¯å¯ç”¨ä¸”å¯é çš„         |
| â†³ always                 | å‰¯è¯                                                       | ä¸€ç›´ã€å§‹ç»ˆ        |                 |
| â†³ available              | å½¢å®¹è¯                                                      | å¯ç”¨çš„          |                 |
| â†³ reliable               | å½¢å®¹è¯                                                      | å¯é çš„          |                 |
| æ–¹å¼çŠ¶è¯­                     | by allocating a sufficient amount of computing resources | ä»‹è¯çŸ­è¯­         | é€šè¿‡åˆ†é…è¶³å¤Ÿçš„è®¡ç®—èµ„æº     |
| â†³ by                     | ä»‹è¯                                                       | é€šè¿‡ï¼Œä»¥â€¦â€¦æ–¹å¼     |                 |
| â†³ allocating             | åŠ¨åè¯                                                      | åˆ†é…ï¼ˆèµ„æºï¼‰       |                 |
| â†³ a sufficient amount of | å½¢å®¹è¯çŸ­è¯­                                                    | è¶³å¤Ÿçš„ï¼ˆç”¨äºä¸å¯æ•°åè¯ï¼‰ |                 |
| â†³ sufficient             | å½¢å®¹è¯                                                      | è¶³å¤Ÿçš„          |                 |
| â†³ amount                 | åè¯                                                       | é‡            |                 |
| â†³ of computing resources | ä»‹è¯çŸ­è¯­                                                     | è®¡ç®—èµ„æºçš„        |                 |
| ç»“æœçŠ¶è¯­ä»å¥å¼•å¯¼                 | so that                                                  | è¿è¯           | ä»¥ä¾¿ã€ä»è€Œï¼ˆè¡¨ç¤ºç»“æœï¼‰     |
| ä»å¥ä¸»è¯­                     | it                                                       | å½¢å¼ä¸»è¯­         | å®ƒï¼ˆå½¢å¼ä¸ŠæŒ‡ä»£åé¢çš„ä»å¥å†…å®¹ï¼‰ |
| è°“è¯­                       | appears                                                  | åŠ¨è¯           | æ˜¾å¾—ã€çœ‹èµ·æ¥          |
| ä»‹è¯çŸ­è¯­                     | to customers                                             | ä»‹è¯çŸ­è¯­         | å¯¹å®¢æˆ·è€Œè¨€           |
| çœŸä¸»è¯­ä»å¥                    | that resources are never in short supply                 | åè¯æ€§ä»å¥        | èµ„æºä»æœªçŸ­ç¼º          |
| â†³ are never              | ç³»åŠ¨è¯ + å¦å®šå‰¯è¯                                               | ä»ä¸ï¼ˆå¦å®šï¼‰       |                 |
| â†³ in short supply        | ä»‹è¯çŸ­è¯­                                                     | ä¾›åº”çŸ­ç¼ºã€ç¨€ç¼ºçŠ¶æ€ä¸­   |                 |

ä¸ºä»€ä¹ˆç”¨ typically ä¸ç”¨ usually frequentlyï¼Ÿ

| å‰¯è¯         | ç¤ºä¾‹å¥                                                          | ä¸­æ–‡ç¿»è¯‘                          |
| ---------- | ------------------------------------------------------------ | ----------------------------- |
| typically  | Cloud providers typically offer multiple availability zones. | äº‘æœåŠ¡å•†**é€šå¸¸**æä¾›å¤šä¸ªå¯ç”¨åŒºã€‚â†’ æ˜¯å¸¸è§„åšæ³•     |
| usually    | I usually back up my files on Fridays.                       | æˆ‘**é€šå¸¸**åœ¨å‘¨äº”å¤‡ä»½æ–‡ä»¶ã€‚â†’ æ˜¯ä¸ªäººä¹ æƒ¯        |
| frequently | Spot instances are frequently terminated without warning.    | Spot å®ä¾‹**ç»å¸¸**åœ¨æ— é¢„è­¦ä¸‹è¢«ç»ˆæ­¢ã€‚â†’ æ˜¯é«˜é¢‘è¡Œä¸º |

Computing with a mixture of VM types. by allocating a sufficient amount of computing resources ä¸ºä»€ä¹ˆä¸Šé¢ç”¨withä¸‹é¢ç”¨by?

| çŸ­è¯­                             | ä»‹è¯   | ä¾§é‡ç‚¹              | ç”¨æ³•ç±»åˆ«     |
| ------------------------------ | ---- | ---------------- | -------- |
| **with a mixture of VM types** | with | è¯´æ˜å‚ä¸è®¡ç®—çš„â€œé…ç½®/æ­é…å·¥å…·â€ | é™ªä¼´ã€æ¡ä»¶ã€ç»„æˆ |
| **by allocating resources**    | by   | è¯´æ˜è¾¾æˆç›®æ ‡çš„â€œæ‰‹æ®µ/æ–¹æ³•â€   | åŠ¨ä½œæ–¹å¼ã€å› æœ  |

## âœ… æ›´ç›´è§‚çš„ç±»æ¯”ï¼š
- I cook **with a wok**. ï¼ˆæˆ‘ç”¨ç‚’é”…ç‚’èœ â†’ å·¥å…·ï¼‰
- I improved the dish **by adding soy sauce**. ï¼ˆæˆ‘é€šè¿‡åŠ é…±æ²¹è®©èœæ›´å¥½åƒ â†’ æ–¹æ³•ï¼‰
## âœ¨ æ€»ç»“ï¼š
- **with** è¯´æ˜â€œä½ ä½¿ç”¨äº†ä»€ä¹ˆæ¥åšè¿™ä»¶äº‹â€ï¼ˆå¼ºè°ƒå‚ä¸æˆ–æˆåˆ†ï¼‰ï¼›  
- **by** è¯´æ˜â€œä½ é€šè¿‡ä»€ä¹ˆåŠ¨ä½œ/æ‰‹æ®µå®ç°äº†ç›®çš„â€ï¼ˆå¼ºè°ƒè¿‡ç¨‹æ–¹å¼ï¼‰ã€‚
---
This often leads to underutilized resources, and cloud providers are motivated to monetize excess capacity by selling them at discounted prices to compensate for the degradation in resource availability.
è¿™å¸¸å¸¸å¯¼è‡´èµ„æºæœªè¢«å……åˆ†åˆ©ç”¨ï¼Œäº‘æœåŠ¡æä¾›å•†å› è€Œè¢«æ¿€åŠ±å°†å¤šä½™å®¹é‡è¿›è¡Œå˜ç°ï¼Œé€šè¿‡ä»¥æŠ˜æ‰£ä»·å‡ºå”®è¿™äº›èµ„æºï¼Œä»¥è¡¥å¿èµ„æºå¯ç”¨æ€§ä¸‹é™æ‰€å¸¦æ¥çš„å½±å“ã€‚

| æˆåˆ†                         | å•è¯/çŸ­è¯­                                                      | è¯æ€§/ç»“æ„      | ä¸­æ–‡å«ä¹‰         |
| -------------------------- | ---------------------------------------------------------- | ---------- | ------------ |
| è°“è¯­                         | leads to                                                   | åŠ¨è¯çŸ­è¯­       | å¯¼è‡´ã€å¼•å‘        |
| å®¾è¯­                         | underutilized resources                                    | å½¢å®¹è¯ + åè¯   | æœªå……åˆ†åˆ©ç”¨çš„èµ„æº     |
| è°“è¯­è¢«åŠ¨                       | are motivated to do...                                     | è¢«åŠ¨ç»“æ„       | è¢«æ¿€åŠ±å»åšâ€¦â€¦      |
| åŠ¨è¯ä¸å®šå¼                      | to monetize excess capacity                                | åŠ¨è¯ä¸å®šå¼      | å°†å¤šä½™èµ„æºå˜ç°      |
| â†³ monetize                 | åŠ¨è¯                                                         | ç›ˆåˆ©åŒ–ã€å˜ç°     |              |
| â†³ excess capacity          | åè¯çŸ­è¯­                                                       | è¿‡å‰©çš„èµ„æºå®¹é‡    |              |
| æ–¹å¼çŠ¶è¯­                       | by selling them at discounted prices                       | by + V-ing | é€šè¿‡ä»¥æŠ˜æ‰£ä»·å‡ºå”®å®ƒä»¬   |
| â†³ at discounted prices     | ä»‹è¯çŸ­è¯­                                                       | ä»¥æ‰“æŠ˜ä»·æ ¼      |              |
| ç›®çš„çŠ¶è¯­                       | to compensate for the degradation in resource availability | ä¸å®šå¼ç»“æ„      | ä¸ºäº†å¼¥è¡¥èµ„æºå¯ç”¨æ€§çš„ä¸‹é™ |
| â†³ compensate for           | åŠ¨è¯çŸ­è¯­                                                       | è¡¥å¿ï¼Œå¼¥è¡¥      |              |
| â†³ degradation              | åè¯                                                         | é™ä½ã€é€€åŒ–      |              |
| â†³ in resource availability | ä»‹è¯çŸ­è¯­                                                       | åœ¨èµ„æºå¯ç”¨æ€§æ–¹é¢   |              |

Example offerings include spot virtual machine (VM), spot block VM and harvest VM.
ç¤ºä¾‹æœåŠ¡åŒ…æ‹¬ï¼šæŠ¢å å¼è™šæ‹Ÿæœºï¼ˆspot VMï¼‰ã€å—çŠ¶æŠ¢å å¼è™šæ‹Ÿæœºï¼ˆspot block VMï¼‰ä»¥åŠæ”¶å‰²å‹è™šæ‹Ÿæœºï¼ˆharvest VMï¼‰ã€‚

| æˆåˆ†          | å•è¯/çŸ­è¯­             | è¯æ€§/ç»“æ„             | ä¸­æ–‡å«ä¹‰               |
| ----------- | ----------------- | ----------------- | ------------------ |
| ä¸»è¯­          | Example offerings | åè¯çŸ­è¯­              | ç¤ºä¾‹äº§å“ / ç¤ºä¾‹æœåŠ¡        |
| â†³ offerings | åè¯å¤æ•°              | æä¾›çš„æœåŠ¡æˆ–äº§å“ï¼ˆç‰¹åˆ«æ˜¯äº‘æœåŠ¡ä¸­ï¼‰ |                    |
| å®¾è¯­ 2        | spot block VM     | åè¯çŸ­è¯­              | æŠ¢å å¼å—çŠ¶è™šæ‹Ÿæœºï¼ˆæœ‰æ—¶é—´çº¦æŸï¼‰    |
| å®¾è¯­ 3        | harvest VM        | åè¯çŸ­è¯­              | å¯æ”¶å‰²å¼è™šæ‹Ÿæœºï¼ˆä½ä¼˜å…ˆçº§ã€æˆæœ¬æ›´ä½ï¼‰ |
| â†³ harvest   | åŠ¨è¯/åè¯             | æ”¶å‰²ã€å¯è¢«ç³»ç»Ÿå›æ”¶         |                    |

The trade-off between cost-effectiveness and resource availability often creates a dilemma for users.
åœ¨æˆæœ¬æ•ˆç›Šä¸èµ„æºå¯ç”¨æ€§ä¹‹é—´çš„æƒè¡¡ï¼Œå¸¸å¸¸è®©ç”¨æˆ·é™·å…¥ä¸¤éš¾ã€‚

| æˆåˆ†                   | å•è¯/çŸ­è¯­                                                              | è¯æ€§/ç»“æ„      | ä¸­æ–‡å«ä¹‰            |
| -------------------- | ------------------------------------------------------------------ | ---------- | --------------- |
| ä¸»è¯­                   | The trade-off between cost-effectiveness and resource availability | åè¯çŸ­è¯­       | åœ¨æ€§ä»·æ¯”ä¸èµ„æºå¯ç”¨æ€§ä¹‹é—´çš„æƒè¡¡ |
| â†³ cost-effectiveness | åè¯                                                                 | æˆæœ¬æ•ˆç›Šã€æ€§ä»·æ¯”   |                 |
| è°“è¯­åŠ¨è¯                 | creates                                                            | åŠ¨è¯         | é€ æˆã€å¸¦æ¥ã€åˆ¶é€         |
| å®¾è¯­                   | a dilemma for users                                                | åè¯çŸ­è¯­       | ç”¨æˆ·é¢ä¸´çš„ä¸¤éš¾å›°å¢ƒ       |
| â†³ a dilemma          | åè¯                                                                 | å›°å¢ƒã€è¿›é€€ä¸¤éš¾çš„å±€é¢ |                 |

On the one hand, some workloads, such as machine learning training and inferencing, caching, and big data processing, can potentially run at reduced reliability for lower cost.
ä¸€æ–¹é¢ï¼Œä¸€äº›å·¥ä½œè´Ÿè½½ï¼ˆå¦‚æœºå™¨å­¦ä¹ è®­ç»ƒä¸æ¨ç†ã€ç¼“å­˜ã€å¤§æ•°æ®å¤„ç†ï¼‰å¯ä»¥åœ¨è¾ƒä½çš„å¯é æ€§ä¸‹è¿è¡Œï¼Œä»¥æ¢å–æ›´ä½çš„æˆæœ¬ã€‚

| æˆåˆ†                    | å•è¯ / çŸ­è¯­                                                                             | è¯æ€§ / ç»“æ„                | ä¸­æ–‡å«ä¹‰                  |
| --------------------- | ----------------------------------------------------------------------------------- | ---------------------- | --------------------- |
| è¿æ¥çŸ­è¯­                  | On the one hand                                                                     | ä»‹è¯çŸ­è¯­                   | ä¸€æ–¹é¢ï¼ˆç”¨äºå¼•å‡ºå¯¹æ¯”ç»“æ„ï¼‰         |
| ä¸»è¯­                    | some workloads                                                                      | å½¢å®¹è¯ + åè¯               | ä¸€äº›å·¥ä½œè´Ÿè½½ï¼ˆä»»åŠ¡ç±»å‹ï¼‰          |
| â†³ workloads           | åè¯                                                                                  | å·¥ä½œè´Ÿè½½ï¼Œä»»åŠ¡ï¼ˆå¦‚è®¡ç®—ä»»åŠ¡ï¼‰         |                       |
| æ’å…¥è¯´æ˜                  | such as machine learning training and inferencing, caching, and big data processing | ä»‹è¯çŸ­è¯­                   | ä¾‹å¦‚ï¼šæœºå™¨å­¦ä¹ è®­ç»ƒä¸æ¨ç†ã€ç¼“å­˜ã€å¤§æ•°æ®å¤„ç† |
| â†³ such as             | ä»‹è¯çŸ­è¯­                                                                                | ä¾‹å¦‚ã€æ¯”å¦‚                  |                       |
| â†³ machine learning    | åè¯çŸ­è¯­                                                                                | æœºå™¨å­¦ä¹                    |                       |
| â†³ training            | åè¯                                                                                  | æ¨¡å‹è®­ç»ƒ                   |                       |
| â†³ inferencing         | åè¯                                                                                  | æ¨¡å‹æ¨ç†ï¼ˆinference çš„åŠ¨åè¯å½¢å¼ï¼‰ |                       |
| â†³ big data processing | åè¯çŸ­è¯­                                                                                | å¤§æ•°æ®å¤„ç†                  |                       |
| æƒ…æ€åŠ¨è¯ + å‰¯è¯             | can potentially                                                                     | æƒ…æ€ + å‰¯è¯                | å¯èƒ½ã€æœ‰æ½œåŠ›åœ°               |
| çŠ¶è¯­ï¼ˆæ¡ä»¶ï¼‰                | at reduced reliability                                                              | ä»‹è¯çŸ­è¯­                   | åœ¨é™ä½çš„å¯é æ€§ä¸‹              |
| â†³ at                  | ä»‹è¯                                                                                  | ä»¥â€¦â€¦çš„çŠ¶æ€ã€æ¡ä»¶ä¸‹             |                       |
| â†³ reduced             | å½¢å®¹è¯ï¼ˆè¿‡å»åˆ†è¯ï¼‰                                                                           | é™ä½äº†çš„                   |                       |
| â†³ reliability         | åè¯                                                                                  | å¯é æ€§                    |                       |
| ç›®çš„çŠ¶è¯­                  | for lower cost                                                                      | ä»‹è¯çŸ­è¯­                   | ä¸ºäº†æ›´ä½çš„æˆæœ¬               |
| â†³ for                 | ä»‹è¯                                                                                  | ä¸ºäº†ï¼Œæ¢å–                  |                       |
| â†³ cost                | åè¯                                                                                  | æˆæœ¬                     |                       |

On the other hand, cloud providers, while sharing some information about resource availability such as estimated eviction rates for spot VMs at the region level, do not guarantee resource availability.

å¦ä¸€æ–¹é¢ï¼Œå°½ç®¡äº‘æœåŠ¡æä¾›å•†ä¼šå…±äº«ä¸€äº›å…³äºèµ„æºå¯ç”¨æ€§çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚åŒºåŸŸçº§åˆ«çš„ spot å®ä¾‹é¢„ä¼°å›æ”¶ç‡ï¼‰ï¼Œä½†ä»–ä»¬å¹¶ä¸ä¿è¯èµ„æºå¯ç”¨æ€§ã€‚

| æˆåˆ†                            | å•è¯ / çŸ­è¯­                                                           | è¯æ€§ / ç»“æ„               | ä¸­æ–‡å«ä¹‰                           |
| ----------------------------- | ----------------------------------------------------------------- | --------------------- | ------------------------------ |
| å¯¹æ¯”çŸ­è¯­                          | On the other hand                                                 | ä»‹è¯çŸ­è¯­                  | å¦ä¸€æ–¹é¢ï¼ˆç”¨äºä¸ä¸Šæ–‡â€œon the one handâ€å¯¹ç…§ï¼‰ |
| ä¸»è¯­                            | cloud providers                                                   | åè¯çŸ­è¯­                  | äº‘æœåŠ¡æä¾›å•†                         |
| æ’å…¥ç»“æ„                          | while sharing some information about resource availability...     | åˆ†è¯ç»“æ„ï¼ˆè®©æ­¥çŠ¶è¯­ï¼‰            | å°½ç®¡ä»–ä»¬å…±äº«ä¸€äº›èµ„æºå¯ç”¨æ€§çš„ä¿¡æ¯               |
| â†³ while                       | è¿è¯                                                                | å°½ç®¡ï¼ˆå¼•å¯¼è®©æ­¥ï¼‰              |                                |
| â†³ some information            | åè¯çŸ­è¯­                                                              | ä¸€äº›ä¿¡æ¯                  |                                |
| â†³ about resource availability | ä»‹è¯çŸ­è¯­                                                              | å…³äºèµ„æºå¯ç”¨æ€§çš„              |                                |
| ä¸¾ä¾‹è¯´æ˜ï¼ˆæ’å…¥ç»“æ„ï¼‰                    | such as estimated eviction rates for spot VMs at the region level | ä»‹è¯çŸ­è¯­                  | ä¾‹å¦‚ï¼šåŒºåŸŸçº§åˆ«çš„ spot VM é¢„ä¼°å›æ”¶ç‡         |
| â†³ such as                     | ä»‹è¯çŸ­è¯­                                                              | ä¾‹å¦‚                    |                                |
| â†³ estimated                   | å½¢å®¹è¯                                                               | ä¼°è®¡çš„ï¼Œé¢„ä¼°çš„               |                                |
| â†³ eviction rates              | åè¯çŸ­è¯­                                                              | å›æ”¶ç‡ï¼Œè¢«é©±é€ç‡ï¼ˆVM è¢«ç³»ç»Ÿä¸­æ–­çš„é¢‘ç‡ï¼‰ |                                |
| â†³ for spot VMs                | ä»‹è¯çŸ­è¯­                                                              | é’ˆå¯¹ spot å®ä¾‹çš„           |                                |
| â†³ at the region level         | ä»‹è¯çŸ­è¯­                                                              | åœ¨åŒºåŸŸçº§åˆ«ï¼ˆè€Œéå…·ä½“å®ä¾‹çº§åˆ«ï¼‰       |                                |
| è°“è¯­                            | do not guarantee                                                  | å¦å®šåŠ¨è¯ç»“æ„                | ä¸ä¿è¯ï¼Œä¸æ‰¿è¯º                        |
| å®¾è¯­                            | resource availability                                             | åè¯çŸ­è¯­                  | èµ„æºå¯ç”¨æ€§                          |

Figure 1 shows an incident caused by the unexpected high evictions of spot VMs.
å›¾ 1 å±•ç¤ºäº†ä¸€èµ·ç”± Spot è™šæ‹Ÿæœºæ„å¤–å¤§è§„æ¨¡å›æ”¶æ‰€å¼•å‘çš„äº‹ä»¶ã€‚

| æˆåˆ†                                             | å•è¯ / çŸ­è¯­                  | è¯æ€§ / ç»“æ„              | ä¸­æ–‡å«ä¹‰                |
| ---------------------------------------------- | ------------------------ | -------------------- | ------------------- |
| å®¾è¯­                                             | an incident caused by... | åè¯çŸ­è¯­                 | ä¸€ä¸ªäº‹ä»¶ï¼ˆç”±â€¦â€¦å¼•èµ·ï¼‰         |
| â†³ an incident                                  | åè¯                       | ä¸€æ¬¡äº‹ä»¶ã€äº‹æ•…              |                     |
| â†³ caused by...                                 | è¿‡å»åˆ†è¯çŸ­è¯­ä½œå®šè¯­                | ç”±â€¦â€¦å¼•èµ·çš„ï¼ˆä¿®é¥° incidentï¼‰  |                     |
| â†³ by the unexpected high evictions of spot VMs | ä»‹è¯çŸ­è¯­                     | ç”±æ„æ–™ä¹‹å¤–çš„å¤§é‡ spot å®ä¾‹å›æ”¶å¼•èµ· |                     |
| â†³ unexpected                                   | å½¢å®¹è¯                      | å‡ºä¹æ„æ–™çš„                |                     |
| â†³ evictions                                    | åè¯ï¼ˆå¤æ•°ï¼‰                   | å›æ”¶ã€é©±é€ï¼ˆspot VM è¢«ç³»ç»Ÿä¸­æ–­ï¼‰ |                     |


For months, prior to the incident, the eviction rate had remained stable, leading service owners to believe it would be safe to use spot VMs with some level of overprovisioning based on the estimated eviction rate.
åœ¨è¯¥äº‹ä»¶å‘ç”Ÿä¹‹å‰çš„å‡ ä¸ªæœˆé‡Œï¼ŒSpot å®ä¾‹çš„å›æ”¶ç‡ä¸€ç›´ä¿æŒç¨³å®šï¼Œè¿™å¯¼è‡´æœåŠ¡æ‹¥æœ‰è€…ç›¸ä¿¡ï¼Œåªè¦åŸºäºä¼°ç®—çš„å›æ”¶ç‡åšä¸€äº›å†—ä½™é…ç½®ï¼Œä½¿ç”¨ Spot å®ä¾‹æ˜¯å®‰å…¨çš„ã€‚

| æˆåˆ†                                    | å•è¯ / çŸ­è¯­                                                | è¯æ€§ / ç»“æ„           | ä¸­æ–‡å«ä¹‰                   |
| ------------------------------------- | ------------------------------------------------------ | ----------------- | ---------------------- |
| æ—¶é—´çŠ¶è¯­ 1                                | For months                                             | ä»‹è¯çŸ­è¯­              | æŒç»­äº†æ•°æœˆ                  |
| æ—¶é—´çŠ¶è¯­ 2                                | prior to the incident                                  | ä»‹è¯çŸ­è¯­              | åœ¨è¯¥äº‹ä»¶ä¹‹å‰                 |
| ä¸»è¯­                                    | the eviction rate                                      | åè¯çŸ­è¯­              | å›æ”¶ç‡ï¼ˆæŒ‡ spot å®ä¾‹è¢«ä¸­æ­¢çš„é¢‘ç‡ï¼‰   |
| è°“è¯­                                    | had remained                                           | è¿‡å»å®Œæˆæ—¶åŠ¨è¯           | ä¸€ç›´ä¿æŒ                   |
| è¡¨è¯­                                    | stable                                                 | å½¢å®¹è¯               | ç¨³å®šçš„                    |
| ç»“æœçŠ¶è¯­                                  | leading service owners to believe...                   | ç°åœ¨åˆ†è¯çŸ­è¯­            | å¯¼è‡´æœåŠ¡æ‰€æœ‰è€…ç›¸ä¿¡â€¦â€¦            |
| â†³ leading                             | ç°åœ¨åˆ†è¯                                                   | å¼•å¯¼ï¼Œå¯¼è‡´ï¼ˆ= causingï¼‰  |                        |
| â†³ service owners                      | åè¯çŸ­è¯­                                                   | æœåŠ¡æ‰€æœ‰è€…ï¼ˆç³»ç»Ÿæˆ–åº”ç”¨è¿ç»´æ–¹ï¼‰   |                        |
| ä¸å®šå¼å®¾è¯­                                 | to believe (that...)                                   | ä¸å®šå¼ç»“æ„             | ç›¸ä¿¡â€¦â€¦                   |
| ä»å¥ä¸»è¯­                                  | it                                                     | å½¢å¼ä¸»è¯­              | å®ƒï¼ˆå½¢å¼ä¸»è¯­ï¼Œä»£æŒ‡åé¢ä¸å®šå¼ï¼‰        |
| ä»å¥è°“è¯­                                  | would be                                               | æƒ…æ€åŠ¨è¯ + be         | å°†æ˜¯ï¼ˆå¸¦æœ‰æ¨æµ‹è¯­æ°”ï¼‰             |
| ä¸å®šå¼çœŸæ­£ä¸»è¯­                               | to use spot VMs with some level of overprovisioning... | ä¸å®šå¼ç»“æ„             | ä½¿ç”¨ Spot å®ä¾‹å¹¶è¿›è¡Œä¸€å®šç¨‹åº¦çš„å†—ä½™é…ç½® |
| â†³ with some level of overprovisioning | ä»‹è¯çŸ­è¯­                                                   | æ­é…æŸç§ç¨‹åº¦çš„è¿‡åº¦é…ç½®ï¼ˆå†—ä½™ä¿éšœï¼‰ |                        |
| â†³ some level of                       | åè¯çŸ­è¯­                                                   | ä¸€å®šç¨‹åº¦çš„             |                        |
| â†³ overprovisioning                    | åè¯                                                     | è¶…é¢é…ç½®ï¼Œé¢„ç•™é¢å¤–èµ„æº       |                        |
| ä¿®é¥°çŠ¶è¯­                                  | based on the estimated eviction rate                   | è¿‡å»åˆ†è¯çŸ­è¯­            | åŸºäºé¢„ä¼°çš„å›æ”¶ç‡               |
| â†³ estimated                           | å½¢å®¹è¯                                                    | é¢„ä¼°çš„               |                        |
| â†³ eviction rate                       | åè¯çŸ­è¯­                                                   | å›æ”¶ç‡ã€è¢«ä¸­æ­¢ç‡          |                        |

However, around 4am, the eviction rate suddenly increased, resulting in the eviction of approximately 60% of spot VMs.
ç„¶è€Œï¼Œåœ¨å‡Œæ™¨å››ç‚¹å·¦å³ï¼ŒSpot å®ä¾‹çš„å›æ”¶ç‡çªç„¶ä¸Šå‡ï¼Œå¯¼è‡´å¤§çº¦ 60% çš„ Spot è™šæ‹Ÿæœºè¢«å›æ”¶ã€‚

| æˆåˆ†                   | å•è¯ / çŸ­è¯­                         | è¯æ€§ / ç»“æ„         | ä¸­æ–‡å«ä¹‰                   |
| -------------------- | ------------------------------- | --------------- | ---------------------- |
| æ—¶é—´çŠ¶è¯­                 | around 4am                      | ä»‹è¯çŸ­è¯­            | å¤§çº¦å‡Œæ™¨å››ç‚¹å·¦å³               |
| ä¸»è¯­                   | the eviction rate               | åè¯çŸ­è¯­            | å›æ”¶ç‡ã€é©±é€ç‡ï¼ˆspot å®ä¾‹è¢«ä¸­æ­¢çš„é¢‘ç‡ï¼‰ |
| å‰¯è¯                   | suddenly                        | å‰¯è¯              | çªç„¶åœ°ï¼Œå‡ºä¹æ„æ–™åœ°              |
| è°“è¯­åŠ¨è¯                 | increased                       | åŠ¨è¯ï¼ˆè¿‡å»å¼ï¼‰         | å¢åŠ ï¼Œä¸Šå‡                  |
| ç»“æœçŠ¶è¯­                 | resulting in the eviction of... | ç°åœ¨åˆ†è¯çŸ­è¯­ï¼ˆç»“æœçŠ¶è¯­ï¼‰    | å¯¼è‡´â€¦â€¦è¢«å›æ”¶ï¼ˆè¡¨ç¤ºç»“æœï¼‰          |
| â†³ resulting in       | ç°åœ¨åˆ†è¯çŸ­è¯­                          | å¯¼è‡´ï¼ˆè¡¨ç¤ºæŸåŠ¨ä½œçš„ç»“æœï¼‰    |                        |
| â†³ the eviction of... | åè¯çŸ­è¯­                            | å¯¹â€¦â€¦çš„é©±é€ï¼ˆè¢«åŠ¨ç»“æœï¼‰    |                        |
| â†³ approximately 60%  | å‰¯è¯ + æ•°è¯                         | å¤§çº¦ 60%          |                        |
| â†³ of spot VMs        | ä»‹è¯çŸ­è¯­                            | Spot è™šæ‹Ÿæœºçš„ï¼ˆæ‰€å±å…³ç³»ï¼‰ |                        |

Although there was no noticeable impact at the time due to low traffic, the service health began to drop around 3pm as traffic increased.
å°½ç®¡å½“æ—¶ç”±äºæµé‡è¾ƒä½å¹¶æœªäº§ç”Ÿæ˜æ˜¾å½±å“ï¼Œä½†éšç€æµé‡åœ¨ä¸‹åˆä¸‰ç‚¹å·¦å³ä¸Šå‡ï¼ŒæœåŠ¡å¥åº·çŠ¶å†µå¼€å§‹ä¸‹é™ã€‚

| æˆåˆ†           | å•è¯ / çŸ­è¯­                        | è¯æ€§ / ç»“æ„         | ä¸­æ–‡å«ä¹‰               |
| ------------ | ------------------------------ | --------------- | ------------------ |
| è®©æ­¥çŠ¶è¯­ä»å¥å¼•å¯¼è¯    | Although                       | è¿è¯              | å°½ç®¡ï¼ˆå¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥ï¼‰       |
| è™šä¸»è¯­ç»“æ„        | there was no noticeable impact | è™šä¸»è¯­å¥å‹           | å¹¶æ— æ˜æ˜¾å½±å“ï¼ˆå½“æ—¶ï¼‰         |
| â†³ there was  | å­˜åœ¨å¥                            | æœ‰â€¦â€¦ï¼ˆç”¨äºæè¿°å‘ç”Ÿ/å­˜åœ¨ï¼‰  |                    |
| â†³ noticeable | å½¢å®¹è¯                            | æ˜æ˜¾çš„ã€å¯å¯Ÿè§‰çš„        |                    |
| â†³ impact     | åè¯                             | å½±å“              |                    |
| æ—¶é—´çŠ¶è¯­         | at the time                    | ä»‹è¯çŸ­è¯­            | åœ¨å½“æ—¶                |
| åŸå› çŠ¶è¯­         | due to low traffic             | ä»‹è¯çŸ­è¯­            | å› ä¸ºæµé‡ä½ï¼ˆè¯´æ˜æ²¡æœ‰å½±å“çš„åŸå› ï¼‰   |
| ä¸»å¥ä¸»è¯­         | the service health             | åè¯çŸ­è¯­            | æœåŠ¡å¥åº·çŠ¶æ€ï¼ˆç³»ç»Ÿç¨³å®šæ€§/å“åº”æŒ‡æ ‡ï¼‰ |
| è°“è¯­åŠ¨è¯çŸ­è¯­       | began to drop                  | åŠ¨è¯ + ä¸å®šå¼        | å¼€å§‹ä¸‹é™               |
| æ—¶é—´çŠ¶è¯­         | around 3pm                     | ä»‹è¯çŸ­è¯­            | å¤§çº¦ä¸‹åˆ 3 ç‚¹           |
| åŸå› çŠ¶è¯­ä»å¥       | as traffic increased           | ä»å±è¿è¯ + åŠ¨è¯       | éšç€æµé‡ä¸Šå‡ï¼ˆè¯´æ˜å¥åº·ä¸‹é™çš„åŸå› ï¼‰  |
| â†³ as         | è¿è¯                             | éšç€â€¦â€¦ï¼ˆè¡¨ç¤ºåŒæ—¶å‘ç”Ÿæˆ–å› æœï¼‰ |                    |
| â†³ traffic    | åè¯                             | æµé‡ï¼ˆè¯·æ±‚é‡ï¼‰         |                    |
| â†³ increased  | åŠ¨è¯ï¼ˆè¿‡å»å¼ï¼‰                        | å¢åŠ ï¼Œä¸Šå‡           |                    |

Figure 1: A real service incident due to unexpected high eviction rates of spot VMs (metrics are normalized and time is shifted to UTC).
å›¾ 1ï¼šä¸€æ¬¡ç”±äº Spot è™šæ‹Ÿæœºæ„å¤–é«˜å›æ”¶ç‡å¼•å‘çš„çœŸå®æœåŠ¡äº‹æ•…ï¼ˆæ‰€æœ‰æŒ‡æ ‡å·²å½’ä¸€åŒ–ï¼Œæ—¶é—´å·²è½¬æ¢ä¸º UTCï¼‰ã€‚

| æˆåˆ†                  | å•è¯ / çŸ­è¯­                                             | è¯æ€§ / ç»“æ„         | ä¸­æ–‡å«ä¹‰                |
| ------------------- | --------------------------------------------------- | --------------- | ------------------- |
| å›¾æ³¨æ ‡è¯†                | Figure 1                                            | ä¸“æœ‰åè¯            | å›¾ 1                 |
| æ ‡é¢˜çŸ­è¯­                | A real service incident                             | å† è¯ + å½¢å®¹è¯ + åè¯çŸ­è¯­ | ä¸€æ¬¡çœŸå®çš„æœåŠ¡äº‹æ•…           |
| åŸå› çŠ¶è¯­                | due to unexpected high eviction rates of spot VMs   | ä»‹è¯çŸ­è¯­            | ç”±äº spot è™šæ‹Ÿæœºçš„æ„å¤–é«˜å›æ”¶ç‡  |
| â†³ due to            | ä»‹è¯çŸ­è¯­                                                | ç”±äºï¼ˆè¡¨ç¤ºåŸå› ï¼‰        |                     |
| â†³ unexpected        | å½¢å®¹è¯                                                 | æ„æ–™ä¹‹å¤–çš„           |                     |
| â†³ eviction rates    | åè¯çŸ­è¯­                                                | å›æ”¶ç‡ï¼Œé©±é€ç‡         |                     |
| â†³ of spot VMs       | ä»‹è¯çŸ­è¯­                                                | Spot å®ä¾‹çš„ï¼ˆæ‰€æœ‰å…³ç³»ï¼‰  |                     |
| æ‹¬å·è¡¥å……è¯´æ˜              | (metrics are normalized and time is shifted to UTC) | æ‹¬å·å¥ï¼Œé™ˆè¿°è¯­æ€        | ï¼ˆæŒ‡æ ‡å·²å½’ä¸€åŒ–ï¼Œæ—¶é—´å·²è½¬æ¢ä¸º UTCï¼‰ |
| â†³ metrics           | åè¯ï¼ˆå¤ï¼‰                                               | æŒ‡æ ‡ã€åº¦é‡å€¼          |                     |
| â†³ are normalized    | è¢«åŠ¨è¯­æ€                                                | è¢«æ ‡å‡†åŒ– / å½’ä¸€åŒ–      |                     |
| â†³ is shifted to UTC | è¢«åŠ¨è¯­æ€ + åœ°ç‚¹çŠ¶è¯­                                         | è¢«è½¬æ¢ä¸ºåè°ƒä¸–ç•Œæ—¶ï¼ˆUTCï¼‰  |                     |

One natural solution to prevent similar incidents as the above is to deploy services in a VM Scaling Group (VMSG) with both spot and on-demand VMs, so that there would still be enough on-demand VMs to support services even if all spot instances were evicted.
ä¸ºäº†é˜²æ­¢ä¸Šè¿°ç±»ä¼¼äº‹ä»¶ï¼Œä¸€ç§è‡ªç„¶çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨ VM æ‰©å±•ç»„ï¼ˆVMSGï¼‰ä¸­éƒ¨ç½²æœåŠ¡ï¼Œæ··åˆä½¿ç”¨ Spot å’Œ On-demand å®ä¾‹ï¼Œè¿™æ ·å³ä½¿æ‰€æœ‰ Spot å®ä¾‹éƒ½è¢«å›æ”¶ï¼Œä¹Ÿä»æœ‰è¶³å¤Ÿçš„ On-demand å®ä¾‹æ¥æ”¯æ’‘æœåŠ¡ã€‚

| æˆåˆ†                                          | å•è¯ / çŸ­è¯­                                                                   | è¯æ€§ / ç»“æ„                 | ä¸­æ–‡å«ä¹‰             |
| ------------------------------------------- | ------------------------------------------------------------------------- | ----------------------- | ---------------- |
| ä¸»è¯­                                          | One natural solution to prevent...                                        | åè¯çŸ­è¯­                    | ä¸€ä¸ªè‡ªç„¶çš„è§£å†³æ–¹æ¡ˆ        |
| â†³ natural solution                          | åè¯çŸ­è¯­                                                                      | è‡ªç„¶çš„ï¼ˆç›´è§‚çš„ï¼‰è§£å†³æ–¹æ³•            |                  |
| â†³ to prevent similar incidents as the above | ä¸å®šå¼çŸ­è¯­                                                                     | é˜²æ­¢ç±»ä¼¼ä¸Šè¿°äº‹ä»¶                |                  |
| è¡¨è¯­                                          | to deploy services in a VM Scaling Group with both spot and on-demand VMs | ä¸å®šå¼ç»“æ„                   | åœ¨ VMSG ä¸­éƒ¨ç½²æ··åˆå®ä¾‹æœåŠ¡ |
| â†³ VM Scaling Group (VMSG)                   | åè¯                                                                        | è™šæ‹Ÿæœºæ‰©å±•ç»„                  |                  |
| â†³ with both spot and on-demand VMs          | ä»‹è¯çŸ­è¯­                                                                      | åŒ…å« Spot å’Œ On-demand è™šæ‹Ÿæœº |                  |
| ç»“æœçŠ¶è¯­ä»å¥                                      | so that...                                                                | è¿è¯å¼•å¯¼                    | ä»¥ä¾¿â€¦â€¦ï¼ˆç›®çš„ï¼‰         |
| â†³ there would still be enough on-demand VMs | è™šæ‹Ÿè¯­æ°”ç»“æ„                                                                    | ä»æœ‰è¶³å¤Ÿçš„æŒ‰éœ€å®ä¾‹               |                  |
| â†³ to support services                       | ä¸å®šå¼                                                                       | æ”¯æ’‘æœåŠ¡                    |                  |
| â†³ even if all spot instances were evicted   | è®©æ­¥ä»å¥                                                                      | å³ä½¿æ‰€æœ‰ Spot å®ä¾‹è¢«å›æ”¶         |                  |

Cloud providers have begun providing such offerings recently as described in Section 2.1.
å¦‚ç¬¬ 2.1 èŠ‚æ‰€è¿°ï¼Œäº‘æœåŠ¡æä¾›å•†è¿‘æ¥ä¹Ÿå·²å¼€å§‹æä¾›è¿™ç±»æœåŠ¡ã€‚

| æˆåˆ†   | å•è¯ / çŸ­è¯­                     | è¯æ€§ / ç»“æ„  | ä¸­æ–‡å«ä¹‰        |
| ---- | --------------------------- | -------- | ----------- |
| è°“è¯­   | have begun providing        | ç°åœ¨å®Œæˆæ—¶    | å·²å¼€å§‹æä¾›       |
| å®¾è¯­   | such offerings              | åè¯çŸ­è¯­     | è¿™ç±»äº§å“/æœåŠ¡     |
| æ—¶é—´çŠ¶è¯­ | recently                    | å‰¯è¯       | æœ€è¿‘          |
| é™„åŠ è¯´æ˜ | as described in Section 2.1 | è¢«åŠ¨è¯­æ€åˆ†è¯çŸ­è¯­ | å¦‚ 2.1 èŠ‚æ‰€æè¿°çš„ |

However, all of them either support a static mixture ratio of spot and on-demand VMs or allocate spot instances in a greedy fashion, which can be less cost-effective when the eviction rate is low.
ç„¶è€Œï¼Œå®ƒä»¬è¦ä¹ˆä»…æ”¯æŒé™æ€çš„ Spot å’Œ On-demand å®ä¾‹é…æ¯”ï¼Œè¦ä¹ˆä»¥è´ªå©ªæ–¹å¼åˆ†é… Spot å®ä¾‹ï¼Œè¿™åœ¨å›æ”¶ç‡è¾ƒä½æ—¶å¯èƒ½æˆæœ¬æ•ˆç‡è¾ƒå·®ã€‚

| æˆåˆ†                               | å•è¯ / çŸ­è¯­                             | è¯æ€§ / ç»“æ„            | æ–‡å«ä¹‰          |
| -------------------------------- | ----------------------------------- | ------------------ | ------------ |
| å¹¶åˆ—è°“è¯­                             | either support... or allocate...    | å¯¹ç­‰ç»“æ„               | è¦ä¹ˆâ€¦â€¦ï¼Œè¦ä¹ˆâ€¦â€¦    |
| â†³ support a static mixture ratio | åŠ¨è¯ + å®¾                              | æ”¯æŒå›ºå®šæ¯”ä¾‹             |              |
| â†³ allocate spot instances        | åŠ¨è¯çŸ­è¯­                                | åˆ†é… Spot å®ä¾‹         |              |
| â†³ in a greedy fashion            | ä»‹è¯çŸ­è¯­                                | ä»¥è´ªå©ªæ–¹å¼ï¼ˆæœ€å¤§åŒ– spot ä½¿ç”¨ï¼‰ |              |
| å®šè¯­ä»å¥                             | which can be less cost-effective... | å…³ç³»ä»£è¯å¼•å¯¼             | è¿™å¯èƒ½åœ¨æŸäº›æƒ…å†µä¸‹ä¸åˆ’ç®— |
| â†³ cost-effective                 | å½¢å®¹è¯                                 | æˆæœ¬æœ‰æ•ˆçš„ï¼Œæœ‰æ€§ä»·æ¯”çš„        |              |
| â†³ when the eviction rate is low  | æ—¶é—´çŠ¶è¯­ä»å¥                              | å½“å›æ”¶ç‡è¾ƒä½æ—¶            |              |

To better balance cost and resource reliability, this work proposes an intelligent framework Snape (Spot On-demand Perfect Mixture), which dynamically adjusts the number of on-demand and spot VMs by leveraging the fact that the eviction of spot VMs is predictable to some extent.
ä¸ºäº†æ›´å¥½åœ°å¹³è¡¡æˆæœ¬ä¸èµ„æºçš„å¯é æ€§ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ä¸ªæ™ºèƒ½æ¡†æ¶ Snapeï¼ˆSpot ä¸ On-demand çš„å®Œç¾æ··åˆï¼‰ã€‚è¯¥æ¡†æ¶å¯ä»¥åŠ¨æ€è°ƒæ•´ Spot å’Œ On-demand å®ä¾‹çš„æ•°é‡ï¼Œæ–¹æ³•æ˜¯åˆ©ç”¨è¿™æ ·ä¸€ä¸ªäº‹å®ï¼šSpot å®ä¾‹çš„å›æ”¶åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯å¯ä»¥é¢„æµ‹çš„ã€‚

| æˆåˆ†ç±»åˆ«                                   | è‹±æ–‡å†…å®¹                                                                 | è¯æ€§ / ç»“æ„                               | æ–‡å«ä¹‰                       |
| -------------------------------------- | -------------------------------------------------------------------- | ------------------------------------- | ------------------------- |
| è°“è¯­                                     | proposes                                                             | åŠ¨è¯                                    | æå‡ºï¼ˆä¸€ä¸ªæ–¹æ¡ˆï¼‰                  |
| å®¾è¯­                                     | an intelligent framework Snape                                       | åè¯çŸ­è¯­                                  | ä¸€ç§æ™ºèƒ½æ¡†æ¶ Snape              |
| â†³ Spot On-demand Perfect Mixture       | ç¼©å†™è§£é‡Š                                                                 | Snape çš„å…¨ç§°ï¼Œæ„æ€æ˜¯â€œSpot ä¸ On-demand çš„å®Œç¾æ··åˆâ€ |                           |
| å®šè¯­ä»å¥                                   | which dynamically adjusts...                                         | å…³ç³»ä»å¥                                  | å®ƒèƒ½åŠ¨æ€è°ƒæ•´...ï¼ˆä¿®é¥° Snapeï¼‰       |
| â†³ dynamically                          | å‰¯è¯                                                                   | åŠ¨æ€åœ°ï¼Œçµæ´»åœ°                               |                           |
| â†³ adjusts                              | åŠ¨è¯                                                                   | è°ƒæ•´ï¼Œè°ƒèŠ‚                                 |                           |
| â†³ the number of on-demand and spot VMs | åè¯çŸ­è¯­                                                                 | æŒ‰éœ€å®ä¾‹ä¸æŠ¢å å¼å®ä¾‹çš„æ•°é‡                         |                           |
| æ–¹æ³•çŠ¶è¯­                                   | by leveraging the fact that...                                       | ä»‹è¯çŸ­è¯­                                  | é€šè¿‡åˆ©ç”¨â€¦â€¦è¿™ä¸€äº‹å®                |
| â†³ leveraging                           | åŠ¨åè¯                                                                  | åˆ©ç”¨ï¼ˆæŸä¸ªä¼˜åŠ¿ã€ç‰¹æ€§ï¼‰                           |                           |
| å®¾è¯­                                     | the fact that the eviction of spot VMs is predictable to some extent | åè¯ä»å¥                                  | Spot å®ä¾‹çš„å›æ”¶åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯å¯é¢„æµ‹çš„è¿™ä¸€äº‹å® |
| â†³ the eviction of spot VMs             | åè¯çŸ­è¯­                                                                 | Spot è™šæ‹Ÿæœºçš„å›æ”¶è¡Œä¸º                         |                           |
| â†³ is predictable                       | ç³»åŠ¨è¯ + å½¢å®¹è¯                                                            | æ˜¯å¯é¢„æµ‹çš„                                 |                           |
| â†³ to some extent                       | å‰¯è¯çŸ­è¯­                                                                 | åœ¨æŸç§ç¨‹åº¦ä¸Š                                |                           |

As the first step to demonstrate the effectiveness of Snape, we introduce a new VMSG in which the number of in-service VMs is equal to or greater than a specified target number that meets a service level objective (SLO), while allowing the number of spot and on-demand VMs to vary for optimized cost saving.
ä¸ºäº†å±•ç¤º Snape çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥ä¸€ä¸ªæ–°çš„ VM æ‰©å±•ç»„ï¼ˆVMSGï¼‰ã€‚
åœ¨è¿™ä¸ªç»„ä¸­ï¼Œæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºæ•°é‡å§‹ç»ˆå¤§äºæˆ–ç­‰äºä¸€ä¸ªé¢„è®¾ç›®æ ‡å€¼ï¼Œè¯¥ç›®æ ‡æ»¡è¶³æœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆSLOï¼‰ï¼›åŒæ—¶ï¼ŒSpot å’Œ On-demand å®ä¾‹çš„æ•°é‡å¯ä»¥çµæ´»å˜åŒ–ï¼Œä»¥å®ç°æˆæœ¬çš„æœ€ä¼˜åŒ–èŠ‚çœã€‚

| æˆåˆ†ç±»åˆ«                                         | è‹±æ–‡å†…å®¹                                                                                           | è¯æ€§ / ç»“æ„                 | ä¸­æ–‡å«ä¹‰                                 |
| -------------------------------------------- | ---------------------------------------------------------------------------------------------- | ----------------------- | ------------------------------------ |
| æ—¶é—´/æ­¥éª¤çŠ¶è¯­                                      | As the first step to demonstrate the effectiveness of Snape                                    | ä»‹è¯çŸ­è¯­                    | ä½œä¸ºå±•ç¤º Snape æœ‰æ•ˆæ€§çš„ç¬¬ä¸€æ­¥                   |
| â†³ As                                         | ä»‹è¯                                                                                             | ä½œä¸ºâ€¦â€¦ï¼ˆè¡¨ç¤ºæ­¥éª¤æˆ–è§’è‰²ï¼‰           |                                      |
| â†³ to demonstrate...                          | ä¸å®šå¼çŸ­è¯­                                                                                          | ä¸ºäº†å±•ç¤ºâ€¦â€¦                  |                                      |
| â†³ the effectiveness of Snape                 | åè¯çŸ­è¯­                                                                                           | Snape çš„æœ‰æ•ˆæ€§              |                                      |
| è°“è¯­                                           | introduce                                                                                      | åŠ¨è¯                      | å¼•å…¥ï¼Œæå‡º                                |
| å®šè¯­ä»å¥                                         | in which the number of in-service VMs is equal to or greater than a specified target number... | å…³ç³»ä»å¥                    | å…¶ä¸­ï¼Œæ­£åœ¨è¿è¡Œçš„ VM æ•°é‡ä¸å°äºæŸä¸ªç›®æ ‡å€¼               |
| â†³ in which                                   | å…³ç³»å‰¯è¯ + ä»‹è¯ç»“æ„                                                                                    | åœ¨å…¶ä¸­ï¼ˆVMSGï¼‰               |                                      |
| â†³ the number of in-service VMs               | åè¯çŸ­è¯­                                                                                           | æ­£åœ¨æœåŠ¡ä¸­çš„ VM æ•°é‡            |                                      |
| â†³ is equal to or greater than                | ç³»åŠ¨è¯ + æ¯”è¾ƒç»“æ„                                                                                     | ç­‰äºæˆ–å¤§äº                   |                                      |
| â†³ a specified target number                  | åè¯çŸ­è¯­                                                                                           | è¢«è®¾å®šçš„ç›®æ ‡æ•°é‡                |                                      |
| â†³ that meets a service level objective (SLO) | å®šè¯­ä»å¥                                                                                           | æ»¡è¶³æœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆSLOï¼‰çš„          |                                      |
| â†³ service level objective (SLO)              | ä¸“ä¸šæœ¯è¯­                                                                                           | æœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆå¦‚å“åº”æ—¶é—´ã€å¯é æ€§ï¼‰       |                                      |
| å¹¶åˆ—çŠ¶è¯­                                         | while allowing the number of spot and on-demand VMs to vary for optimized cost saving          | ç°åœ¨åˆ†è¯ç»“æ„ï¼ˆä¼´éšçŠ¶è¯­ï¼‰            | åŒæ—¶å…è®¸ Spot ä¸ On-demand VM æ•°é‡å˜åŠ¨ä»¥å®ç°æˆæœ¬ä¼˜åŒ– |
| â†³ while                                      | è¿è¯                                                                                             | åŒæ—¶/ä¸æ­¤åŒæ—¶                 |                                      |
| â†³ allowing                                   | ç°åœ¨åˆ†è¯                                                                                           | å…è®¸ï¼Œä½¿å¾—                   |                                      |
| â†³ the number of spot and on-demand VMs       | åè¯çŸ­è¯­                                                                                           | Spot ä¸ On-demand è™šæ‹Ÿæœºçš„æ•°é‡ |                                      |
| â†³ to vary                                    | ä¸å®šå¼                                                                                            | å‘ç”Ÿå˜åŒ–ï¼Œæµ®åŠ¨                 |                                      |
| â†³ for optimized cost saving                  | ä»‹è¯çŸ­è¯­                                                                                           | ä¸ºäº†ä¼˜åŒ–æˆæœ¬èŠ‚çœï¼ˆç›®æ ‡ï¼‰            |                                      |

We defined the VMSG SLO in Section 3.2 regarding the availability of VMs. Customers provide both the target number of in-service VMs and the Service Level Objectives (SLOs). SLOs can be less strict (e.g., three nines) than those for on-demand VMs (four or five nines).
æˆ‘ä»¬åœ¨ç¬¬ 3.2 èŠ‚ä¸­å®šä¹‰äº† VMSGï¼ˆè™šæ‹Ÿæœºæ‰©å±•ç»„ï¼‰çš„æœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆSLOï¼‰ï¼Œå…¶é‡ç‚¹åœ¨äºè™šæ‹Ÿæœºçš„å¯ç”¨æ€§ã€‚  
å®¢æˆ·éœ€è¦æä¾›ä¸¤é¡¹å†…å®¹ï¼šç›®æ ‡è¿è¡Œè™šæ‹Ÿæœºçš„æ•°é‡ï¼Œä»¥åŠæœŸæœ›çš„æœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆSLOï¼‰ã€‚  
ç›¸è¾ƒäºæŒ‰éœ€è™šæ‹Ÿæœºé€šå¸¸è¦æ±‚çš„æ›´é«˜å¯ç”¨æ€§ï¼ˆä¾‹å¦‚å››ä¸ªä¹æˆ–äº”ä¸ªä¹ï¼‰ï¼Œè¿™ç±» SLO é€šå¸¸å¯ä»¥è®¾å®šå¾—è¾ƒä¸ºå®½æ¾ï¼ˆä¾‹å¦‚ä¸‰ä¸ªä¹ï¼‰ã€‚

| **æˆåˆ†ç±»åˆ«**                              | **è‹±æ–‡å†…å®¹**                                                                         | **è¯æ€§ / ç»“æ„**                     | **ä¸­æ–‡å«ä¹‰**                      |
| ------------------------------------- | -------------------------------------------------------------------------------- | ------------------------------- | ----------------------------- |
| è°“è¯­                                    | defined                                                                          | åŠ¨è¯è¿‡å»å¼                           | å®šä¹‰äº†                           |
| å®¾è¯­                                    | the VMSG SLO                                                                     | åè¯çŸ­è¯­                            | VMSGï¼ˆè™šæ‹Ÿæœºæ‰©å±•ç»„ï¼‰çš„æœåŠ¡æ°´å¹³ç›®æ ‡           |
| ä»‹è¯è¡¥è¶³è¯´æ˜                                | regarding the availability of VMs                                                | ä»‹è¯çŸ­è¯­                            | å…³äºè™šæ‹Ÿæœºçš„å¯ç”¨æ€§                     |
| ä¸»è¯­                                    | Customers                                                                        | åè¯å¤æ•°                            | å®¢æˆ·                            |
| å®¾è¯­ï¼ˆå¹¶åˆ—ï¼‰                                | both the target number of in-service VMs and the Service Level Objectives (SLOs) | å¹¶åˆ—åè¯ç»“æ„                          | æä¾›è¿è¡Œä¸­è™šæ‹Ÿæœºçš„ç›®æ ‡æ•°é‡å’ŒæœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆSLOï¼‰     |
| â†³ the target number of in-service VMs | åè¯çŸ­è¯­                                                                             | æ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºçš„ç›®æ ‡æ•°é‡                   |                               |
| â†³ the Service Level Objectives (SLOs) | åè¯çŸ­è¯­                                                                             | æœåŠ¡æ°´å¹³ç›®æ ‡                          |                               |
| ä¸»è¯­                                    | SLOs                                                                             | åè¯å¤æ•°                            | æœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆå¤æ•°ï¼‰                    |
| è°“è¯­                                    | can be less strict                                                               | æƒ…æ€åŠ¨è¯ + å½¢å®¹è¯                      | å¯ä»¥ä¸é‚£ä¹ˆä¸¥æ ¼                       |
| ä¾‹å­ï¼ˆæ’å…¥è¯­ï¼‰                               | (e.g., three nines)                                                              | æ‹¬å·è¯´æ˜                            | ä¾‹å¦‚â€œä¸‰ä¸ªä¹â€â€”â€”å³ 99.9% å¯ç”¨æ€§          |
| æ¯”è¾ƒç»“æ„                                  | than those for on-demand VMs                                                     | æ¯”è¾ƒå¥                             | æ¯”èµ·æŒ‰éœ€è™šæ‹Ÿæœºï¼ˆOn-demand VMï¼‰çš„ç›®æ ‡æ¥è¯´æ›´å®½æ¾ |
| â†³ four or five nines                  | åè¯çŸ­è¯­ï¼ˆæ‹¬å·å¼•æ–‡ï¼‰                                                                       | å››ä¸ªä¹ï¼ˆ99.99%ï¼‰æˆ–äº”ä¸ªä¹ï¼ˆ99.999%ï¼‰çš„é«˜å¯ç”¨æ€§æ ‡å‡† |                               |

| è¡¨è¾¾ï¼ˆå¯ç”¨æ€§ç™¾åˆ†æ¯”ï¼‰        | æ¯å¹´å…è®¸ä¸­æ–­æ—¶é—´      |
| ----------------- | ------------- |
| 3 nines (99.9%)   | ä¸€å¹´ä¸­æœ€å¤š 8.76 å°æ—¶ |
| 4 nines (99.99%)  | ä¸€å¹´ä¸­æœ€å¤š 52.6 åˆ†é’Ÿ |
| 5 nines (99.999%) | ä¸€å¹´ä¸­æœ€å¤š 5.26 åˆ†é’Ÿ |

Obtaining an optimal mixture plan is challenging on several aspects:
è·å¾—ä¸€ä¸ªæœ€ä¼˜çš„æ··åˆç­–ç•¥ï¼ˆå³ Spot ä¸ On-demand å®ä¾‹çš„ç»„åˆï¼‰åœ¨å¤šä¸ªæ–¹é¢éƒ½é¢ä¸´æŒ‘æˆ˜ï¼š
(1) To predict the evictions of spot VMs, the various factors leading to eviction at both global and local levels need to be studied.
1. é¢„æµ‹ Spot å®ä¾‹çš„å›æ”¶è¡Œä¸ºéå¸¸å›°éš¾ï¼Œå› ä¸ºå¿…é¡»ç ”ç©¶å¤šä¸ªå¯¼è‡´å›æ”¶çš„å› ç´ ï¼Œè¿™äº›å› ç´ æ—¢åŒ…æ‹¬å…¨å±€å±‚é¢ä¹ŸåŒ…æ‹¬æœ¬åœ°å±‚é¢ã€‚ 
(2) The uncertainty associated with eviction rate prediction makes tracking the SLO over time complex; optimal mixture decisions would depend on the available SLO budget and the level of uncertainty in the prediction.
2. å›æ”¶ç‡é¢„æµ‹ä¸­å­˜åœ¨çš„ä¸ç¡®å®šæ€§ä½¿å¾—åœ¨æ—¶é—´ä¸ŠæŒç»­æ»¡è¶³ SLO å˜å¾—å¤æ‚ï¼›è€Œæœ€ä¼˜çš„æ··åˆå†³ç­–å¾€å¾€ä¾èµ–äºå¯ç”¨çš„ SLO é¢„ç®—ï¼Œä»¥åŠé¢„æµ‹ä¸­ä¸ç¡®å®šæ€§çš„ç¨‹åº¦ã€‚
(3) A less-optimized â€œmyopicâ€ decision could be made if only short-term eviction prediction results are considered. This can arise when the eviction rate is fast-varying.
3. å¦‚æœä»…è€ƒè™‘çŸ­æœŸé¢„æµ‹ç»“æœï¼Œå¯èƒ½ä¼šåšå‡ºæ¬¡ä¼˜çš„â€œçŸ­è§†å‹â€å†³ç­–ï¼ˆmyopic decisionï¼‰ï¼›è¿™ç§æƒ…å†µå¸¸è§äºå›æ”¶ç‡å˜åŒ–å‰§çƒˆçš„åœºæ™¯ä¸­ã€‚

| **æˆåˆ†ç±»åˆ«** | **è‹±æ–‡å†…å®¹**                          | **è¯æ€§ / ç»“æ„** | **ä¸­æ–‡å«ä¹‰**        |
| -------- | --------------------------------- | ----------- | --------------- |
| ä¸»è¯­ç»“æ„ï¼ˆæ€»è¿°ï¼‰ | Obtaining an optimal mixture plan | åŠ¨åè¯çŸ­è¯­       | è·å¾—ä¸€ä¸ªæœ€ä¼˜çš„æ··åˆç­–ç•¥ï¼ˆä¸»è¯­ï¼‰ |
| è¡¨è¯­       | challenging on several aspects    | å½¢å®¹è¯çŸ­è¯­       | åœ¨å¤šä¸ªæ–¹é¢å…·æœ‰æŒ‘æˆ˜æ€§      |

| æˆåˆ†ç±»åˆ«                              | è‹±æ–‡å†…å®¹                                                                    | è¯æ€§ / ç»“æ„       | ä¸­æ–‡å«ä¹‰                 |
| --------------------------------- | ----------------------------------------------------------------------- | ------------- | -------------------- |
| ä¸å®šå¼ç›®çš„çŠ¶è¯­                           | To predict the evictions of spot VMs                                    | ä¸å®šå¼çŸ­è¯­         | ä¸ºäº†é¢„æµ‹ Spot å®ä¾‹çš„å›æ”¶è¡Œä¸º    |
| ä¸»è¯­                                | the various factors leading to eviction at both global and local levels | åè¯çŸ­è¯­ + ç°åœ¨åˆ†è¯ä»å¥ | å„ç§å¯¼è‡´å›æ”¶çš„å› ç´ ï¼ˆåŒ…æ‹¬å…¨å±€å’Œæœ¬åœ°å±‚é¢ï¼‰ |
| â†³ leading to eviction             | åˆ†è¯çŸ­è¯­ï¼ˆåç½®å®šè¯­ï¼‰                                                              | å¯¼è‡´å›æ”¶çš„         |                      |
| â†³ at both global and local levels | ä»‹è¯çŸ­è¯­                                                                    | åœ¨å…¨å±€ä¸æœ¬åœ°ä¸¤ä¸ªå±‚é¢ä¸Š   |                      |
| è°“è¯­                                | need to be studied                                                      | è¢«åŠ¨è¯­æ€          | éœ€è¦è¢«ç ”ç©¶                |

| æˆåˆ†ç±»åˆ«                                     | è‹±æ–‡å†…å®¹                                                     | è¯æ€§ / ç»“æ„      | ä¸­æ–‡å«ä¹‰          |
| ---------------------------------------- | -------------------------------------------------------- | ------------ | ------------- |
| ä¸»è¯­                                       | The uncertainty associated with eviction rate prediction | åè¯çŸ­è¯­ + ä»‹è¯çŸ­è¯­  | ä¸å›æ”¶ç‡é¢„æµ‹ç›¸å…³çš„ä¸ç¡®å®šæ€§ |
| â†³ associated with...                     | è¿‡å»åˆ†è¯çŸ­è¯­                                                   | ä¸â€¦â€¦ç›¸å…³çš„       |               |
| å®¾è¯­                                       | tracking the SLO over time complex                       | åè¯çŸ­è¯­ + å½¢å®¹è¯   | é•¿æœŸè·Ÿè¸ª SLO å˜å¾—å¤æ‚ |
| å¹¶åˆ—å¥ï¼ˆåˆ†å·è¿æ¥ï¼‰                                | optimal mixture decisions would depend on...             | æ¡ä»¶çŠ¶è¯­å¥ç»“æ„      | æœ€ä¼˜æ··åˆå†³ç­–ä¾èµ–äºâ€¦â€¦   |
| â†³ the available SLO budget               | åè¯çŸ­è¯­                                                     | å¯ç”¨çš„ SLO é¢„ç®—   |               |
| â†³ the level of uncertainty in prediction | åè¯çŸ­è¯­                                                     | é¢„æµ‹è¿‡ç¨‹ä¸­çš„ä¸ç¡®å®šæ€§ç¨‹åº¦ |               |

|æˆåˆ†ç±»åˆ«|è‹±æ–‡å†…å®¹|è¯æ€§ / ç»“æ„|ä¸­æ–‡å«ä¹‰|
|---|---|---|---|
|ä¸»è¯­|A less-optimized â€œmyopicâ€ decision|åè¯çŸ­è¯­|ä¸€ä¸ªä¼˜åŒ–ç¨‹åº¦è¾ƒä½çš„â€œçŸ­è§†å‹â€å†³ç­–|
|æƒ…æ€è°“è¯­|could be made|æƒ…æ€åŠ¨è¯ + è¢«åŠ¨è¯­æ€|å¯èƒ½è¢«åšå‡º|
|æ¡ä»¶çŠ¶è¯­ä»å¥|if only short-term eviction prediction results are considered|if å¼•å¯¼æ¡ä»¶å¥ç»“æ„|å¦‚æœåªè€ƒè™‘çŸ­æœŸçš„å›æ”¶é¢„æµ‹ç»“æœ|
|ç»“æœå¥|This can arise when the eviction rate is fast-varying|ç»“æœå¥ï¼ˆthis æŒ‡ä¸Šæ–‡æ‰€è¿°æƒ…å†µï¼‰|è¿™ç§æƒ…å†µå¯èƒ½å‡ºç°åœ¨å›æ”¶ç‡å¿«é€Ÿæ³¢åŠ¨æ—¶|
|â†³ when the eviction rate is fast-varying|æ—¶é—´çŠ¶è¯­ä»å¥|å½“å›æ”¶ç‡å˜åŒ–å¾ˆå¿«æ—¶||

To address these challenges, we first characterize the eviction behaviors of spot VMs by examining traces collected over three months from a leading cloud provider in Section 3.
ä¸ºäº†è§£å†³è¿™äº›æŒ‘æˆ˜ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨ç¬¬ 3 èŠ‚ä¸­ï¼Œé€šè¿‡åˆ†ææ¥è‡ªä¸€å®¶é¢†å…ˆäº‘æœåŠ¡æä¾›å•†ã€ä¸ºæœŸä¸‰ä¸ªæœˆçš„ä½¿ç”¨è¿½è¸ªæ•°æ®ï¼Œåˆ»ç”»äº† Spot å®ä¾‹çš„å›æ”¶è¡Œä¸ºç‰¹å¾ã€‚

| **æˆåˆ†ç±»åˆ«**                      | **è‹±æ–‡å†…å®¹**                                        | **è¯æ€§ / ç»“æ„**          | **ä¸­æ–‡å«ä¹‰**         |
| ----------------------------- | ----------------------------------------------- | -------------------- | ---------------- |
| ç›®çš„çŠ¶è¯­                          | To address these challenges                     | ä¸å®šå¼çŸ­è¯­                | ä¸ºäº†è§£å†³è¿™äº›æŒ‘æˆ˜         |
| è°“è¯­                            | first characterize                              | åŠ¨è¯çŸ­è¯­ï¼ˆfirst ä¸ºå‰¯è¯ï¼Œè¡¨ç¤ºé¡ºåºï¼‰ | é¦–å…ˆåˆ»ç”» / åˆ†æ        |
| å®¾è¯­                            | the eviction behaviors of spot VMs              | åè¯çŸ­è¯­                 | Spot è™šæ‹Ÿæœºçš„å›æ”¶è¡Œä¸º    |
| æ–¹æ³•çŠ¶è¯­                          | by examining traces collected over three months | ä»‹è¯çŸ­è¯­                 | é€šè¿‡åˆ†æä¸‰ä¸ªæœˆæ”¶é›†çš„ä½¿ç”¨ç—•è¿¹æ•°æ® |
| â†³ examining traces            | åŠ¨åè¯çŸ­è¯­                                           | æ£€æŸ¥ / åˆ†æï¼ˆå†å²ï¼‰è¿½è¸ªæ•°æ®      |                  |
| â†³ collected over three months | è¿‡å»åˆ†è¯çŸ­è¯­ï¼ˆä¿®é¥° tracesï¼‰                               | åœ¨ä¸‰ä¸ªæœˆå†…æ”¶é›†çš„             |                  |
| åœ°ç‚¹/å‡ºå¤„çŠ¶è¯­                       | from a leading cloud provider                   | ä»‹è¯çŸ­è¯­                 | æ¥è‡ªæŸå¤´éƒ¨äº‘æœåŠ¡æä¾›å•†      |


For example, we find that the eviction rate is higher on weekdays and working hours, and spot VMs are more likely to get evicted if collocated with a few on-demand VMs.
ä¾‹å¦‚ï¼Œæˆ‘ä»¬å‘ç°ï¼šSpot å®ä¾‹çš„å›æ”¶ç‡åœ¨å·¥ä½œæ—¥å’Œå·¥ä½œæ—¶é—´æ›´é«˜ï¼›å¹¶ä¸”å¦‚æœå®ƒä»¬ä¸å°‘é‡æŒ‰éœ€å®ä¾‹éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œè¢«å›æ”¶çš„æ¦‚ç‡ä¹Ÿæ›´é«˜ã€‚

| **æˆåˆ†ç±»åˆ«**                         | **è‹±æ–‡å†…å®¹**                                                       | **è¯æ€§ / ç»“æ„**         | **ä¸­æ–‡å«ä¹‰**                 |
| -------------------------------- | -------------------------------------------------------------- | ------------------- | ------------------------ |
| å®¾è¯­ä»å¥ï¼ˆå®Œæ•´å¥ï¼‰                        | that the eviction rate is higher on weekdays and working hours | å®¾è¯­ä»å¥                | å›æ”¶ç‡åœ¨å·¥ä½œæ—¥å’Œå·¥ä½œæ—¶é—´æ›´é«˜           |
| â†³ the eviction rate              | åè¯çŸ­è¯­                                                           | å›æ”¶ç‡ï¼ˆspot VM è¢«æ”¶å›çš„æ¯”ä¾‹ï¼‰ |                          |
| â†³ on weekdays and working hours  | ä»‹è¯çŸ­è¯­                                                           | åœ¨å·¥ä½œæ—¥å’Œå·¥ä½œæ—¶é—´           |                          |
| å¹¶åˆ—å¥                              | and spot VMs are more likely to get evicted                    | å¹¶åˆ—ç»“æ„                | å¹¶ä¸” spot VM æ›´æœ‰å¯èƒ½è¢«å›æ”¶       |
| â†³ are more likely to get evicted | ç³»åŠ¨è¯ + æƒ…æ€è¡¨è¾¾ + è¢«åŠ¨åŠ¨è¯ç»“æ„                                            | æ›´æœ‰å¯èƒ½è¢«å›æ”¶             |                          |
| æ¡ä»¶çŠ¶è¯­                             | if collocated with a few on-demand VMs                         | if æ¡ä»¶å¥              | å¦‚æœä¸å°‘é‡ on-demand å®ä¾‹éƒ¨ç½²åœ¨ä¸€èµ·æ—¶ |
| â†³ collocated                     | è¿‡å»åˆ†è¯                                                           | å…±ç½®ï¼Œéƒ¨ç½²åœ¨åŒä¸€ç‰©ç†æœº/èµ„æºæ± ä¸Š    |                          |
| â†³ with a few on-demand VMs       | ä»‹è¯çŸ­è¯­                                                           | ä¸å°‘æ•°æŒ‰éœ€å®ä¾‹ä¸€èµ·           |                          |

Furthermore, to better learn the eviction behaviors and achieve optimal decisions in the long term, we employ the framework of constrained reinforcement learning (CRL) and discuss how CRL can be applied to the current problem.
æ­¤å¤–ï¼Œä¸ºäº†æ›´å¥½åœ°äº†è§£ Spot å®ä¾‹çš„å›æ”¶è¡Œä¸ºï¼Œå¹¶åœ¨é•¿æœŸå†…å®ç°æœ€ä¼˜å†³ç­–ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†å—é™å¼ºåŒ–å­¦ä¹ ï¼ˆCRLï¼‰æ¡†æ¶ï¼Œå¹¶æ¢è®¨äº†å¦‚ä½•å°†å…¶åº”ç”¨äºå½“å‰é—®é¢˜ã€‚

| **æˆåˆ†ç±»åˆ«**                       | **è‹±æ–‡å†…å®¹**                                                                              | **è¯æ€§ / ç»“æ„**     | **ä¸­æ–‡å«ä¹‰**               |
| ------------------------------ | ------------------------------------------------------------------------------------- | --------------- | ---------------------- |
| è¿æ¥å‰¯è¯ï¼ˆé€’è¿›ï¼‰                       | Furthermore                                                                           | å‰¯è¯              | æ­¤å¤– / æ›´è¿›ä¸€æ­¥åœ°             |
| ä¸å®šå¼ç›®çš„çŠ¶è¯­                        | to better learn the eviction behaviors and achieve optimal decisions in the long term | ä¸å®šå¼å¹¶åˆ—ç»“æ„         | ä¸ºäº†æ›´å¥½åœ°äº†è§£å›æ”¶è¡Œä¸ºï¼Œå¹¶åœ¨é•¿æœŸå®ç°æœ€ä¼˜å†³ç­– |
| â†³ learn the eviction behaviors | åŠ¨è¯ + å®¾è¯­                                                                               | äº†è§£ Spot å®ä¾‹çš„å›æ”¶è¡Œä¸º |                        |
| â†³ achieve optimal decisions    | åŠ¨è¯ + å®¾è¯­                                                                               | å®ç°æœ€ä¼˜å†³ç­–          |                        |
| â†³ in the long term             | ä»‹è¯çŸ­è¯­                                                                                  | ä»é•¿æœŸæ¥çœ‹           |                        |
| è°“è¯­                             | employ                                                                                | åŠ¨è¯              | é‡‡ç”¨ï¼Œä½¿ç”¨                  |
| å®¾è¯­                             | the framework of constrained reinforcement learning (CRL)                             | åè¯çŸ­è¯­            | å—é™å¼ºåŒ–å­¦ä¹ ï¼ˆCRLï¼‰æ¡†æ¶          |
| å¹¶åˆ—è°“è¯­                           | and discuss                                                                           | åŠ¨è¯              | å¹¶è®¨è®º                    |
| å®¾è¯­ä»å¥                           | how CRL can be applied to the current problem                                         | è¿æ¥è¯å¼•å¯¼çš„å®¾è¯­ä»å¥      | CRL å¦‚ä½•åº”ç”¨äºå½“å‰é—®é¢˜          |
| â†³ how CRL can be applied       | æƒ…æ€ + è¢«åŠ¨è¯­æ€                                                                             | å¦‚ä½•èƒ½å¤Ÿè¢«åº”ç”¨ï¼ˆè¢«åŠ¨è¯­æ€ï¼‰   |                        |
| â†³ to the current problem       | ä»‹è¯çŸ­è¯­                                                                                  | åˆ°å½“å‰çš„é—®é¢˜ä¸­         |                        |

The overall architecture of Snape and its components are introduced in Section 4, followed by a detailed evaluation in Section 5.
Snape çš„æ•´ä½“æ¶æ„åŠå…¶ç»„ä»¶å°†åœ¨ç¬¬ 4 èŠ‚ä¸­ä»‹ç»ï¼Œéšååœ¨ç¬¬ 5 èŠ‚è¿›è¡Œè¯¦ç»†è¯„ä¼°ã€‚

| **æˆåˆ†ç±»åˆ«**                            | **è‹±æ–‡å†…å®¹**                                             | **è¯æ€§ / ç»“æ„**     | **ä¸­æ–‡å«ä¹‰**         |
| ----------------------------------- | ---------------------------------------------------- | --------------- | ---------------- |
| ä¸»è¯­                                  | The overall architecture of Snape and its components | åè¯å¹¶åˆ—ç»“æ„          | Snape çš„æ•´ä½“æ¶æ„ä»¥åŠå…¶ç»„ä»¶ |
| â†³ the overall architecture of Snape | åè¯çŸ­è¯­                                                 | Snape çš„æ•´ä½“æ¶æ„     |                  |
| â†³ its components                    | åè¯çŸ­è¯­                                                 | å®ƒï¼ˆSnapeï¼‰çš„ç»„ä»¶     |                  |
| è°“è¯­                                  | are introduced                                       | è¢«åŠ¨è¯­æ€ï¼ˆbe + p.p.ï¼‰ | è¢«ä»‹ç»              |
| å¹¶åˆ—çŠ¶è¯­ç»“æ„                              | followed by a detailed evaluation in Section 5       | åˆ†è¯ç»“æ„ï¼ˆè¿‡å»åˆ†è¯ä½œçŠ¶è¯­ï¼‰   | æ¥ç€æ˜¯ç¬¬ 5 èŠ‚çš„è¯¦ç»†è¯„ä¼°    |
| â†³ followed by...                    | åˆ†è¯ç»“æ„                                                 | ç´§æ¥ç€â€¦â€¦ï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†æ˜¯â€¦â€¦ |                  |
| â†³ a detailed evaluation             | åè¯çŸ­è¯­                                                 | ä¸€é¡¹è¯¦ç»†çš„è¯„ä¼°         |                  |
| â†³ in Section 5                      | ä»‹è¯çŸ­è¯­                                                 | åœ¨ç¬¬ 5 èŠ‚ä¸­         |                  |

**Our contributions can be summarized as follows:**  
â€¢ To the best of our knowledge, we are the first to conduct a detailed characterization of the eviction behavior of spot VMs by analyzing real production traces from Microsoft Azure.  
â€¢ We design a constrained reinforcement learning framework, Snape, which can dynamically adjust the mixture number of on-demand and spot VM to maximize cost savings as well as satisfy the specified SLO provided by users.  
â€¢ We implement an example VM scaling group under the framework of Snape. We validate its effectiveness in experiments that Snape achieves 44% savings than on-demand VMSG while retaining 99.96% availability.
æˆ‘ä»¬çš„è´¡çŒ®æ€»ç»“å¦‚ä¸‹ï¼š
1. æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œæˆ‘ä»¬æ˜¯ç¬¬ä¸€ä¸ªé€šè¿‡åˆ†æ Microsoft Azure çš„çœŸå®ç”Ÿäº§è¿½è¸ªæ•°æ®ï¼Œè¯¦ç»†åˆ»ç”» Spot è™šæ‹Ÿæœºå›æ”¶è¡Œä¸ºçš„ç ”ç©¶è€…ã€‚
2. æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªå—é™å¼ºåŒ–å­¦ä¹ ï¼ˆCRLï¼‰æ¡†æ¶ Snapeï¼Œå®ƒå¯ä»¥åŠ¨æ€è°ƒæ•´æŒ‰éœ€å®ä¾‹å’Œ Spot å®ä¾‹çš„æ··åˆæ¯”ä¾‹ï¼Œä»¥æœ€å¤§åŒ–æˆæœ¬èŠ‚çœï¼ŒåŒæ—¶æ»¡è¶³ç”¨æˆ·è®¾å®šçš„ SLOï¼ˆæœåŠ¡æ°´å¹³ç›®æ ‡ï¼‰ã€‚
3. æˆ‘ä»¬åœ¨ Snape æ¡†æ¶ä¸‹å®ç°äº†ä¸€ä¸ªç¤ºä¾‹è™šæ‹Ÿæœºæ‰©å±•ç»„ï¼Œå¹¶åœ¨å®éªŒä¸­éªŒè¯äº†å…¶æœ‰æ•ˆæ€§ï¼šSnape ç›¸è¾ƒäºä»…ä½¿ç”¨æŒ‰éœ€å®ä¾‹çš„ VMSG å®ç°äº† 44% çš„æˆæœ¬èŠ‚çœï¼ŒåŒæ—¶ä¿æŒäº† 99.96% çš„å¯ç”¨æ€§ã€‚

|**æˆåˆ†ç±»åˆ«**|**è‹±æ–‡å†…å®¹**|**è¯æ€§ / ç»“æ„**|**ä¸­æ–‡å«ä¹‰**|
|---|---|---|---|
|ä¸»å¥ç»“æ„|Our contributions can be summarized as follows|è¢«åŠ¨è¯­æ€ + å¥å‹|æˆ‘ä»¬çš„è´¡çŒ®å¯æ€»ç»“å¦‚ä¸‹ï¼š|

| æˆåˆ†ç±»åˆ«   | è‹±æ–‡å†…å®¹                                                             | è¯æ€§ / ç»“æ„       | ä¸­æ–‡å«ä¹‰                             |
| ------ | ---------------------------------------------------------------- | ------------- | -------------------------------- |
| é™å®šå‰¯è¯çŸ­è¯­ | To the best of our knowledge                                     | å‰¯è¯çŸ­è¯­          | æ®æˆ‘ä»¬æ‰€çŸ¥                            |
| è°“è¯­     | are the first to conduct                                         | be åŠ¨è¯ + ä¸å®šå¼çŸ­è¯­ | æ˜¯ç¬¬ä¸€ä¸ªåšâ€¦â€¦çš„äºº                        |
| å®¾è¯­è¡¥è¶³è¯­  | a detailed characterization of the eviction behavior of spot VMs | åè¯çŸ­è¯­          | å¯¹ Spot VM å›æ”¶è¡Œä¸ºçš„è¯¦ç»†åˆ»ç”»              |
| æ–¹æ³•çŠ¶è¯­   | by analyzing real production traces from Microsoft Azure         | ä»‹è¯çŸ­è¯­          | é€šè¿‡åˆ†ææ¥è‡ª Microsoft Azure çš„å®é™…ç”Ÿäº§è¿½è¸ªæ•°æ® |

| æˆåˆ†ç±»åˆ«                        | è‹±æ–‡å†…å®¹                                                  | è¯æ€§ / ç»“æ„                  | ä¸­æ–‡å«ä¹‰                |
| --------------------------- | ----------------------------------------------------- | ------------------------ | ------------------- |
| å®¾è¯­                          | a constrained reinforcement learning framework, Snape | åè¯çŸ­è¯­                     | ä¸€ä¸ªå—é™å¼ºåŒ–å­¦ä¹ æ¡†æ¶ï¼Œåä¸º Snape |
| å®šè¯­ä»å¥                        | which can dynamically adjust...                       | å…³ç³»ä»å¥                     | å®ƒå¯ä»¥åŠ¨æ€è°ƒæ•´â€¦â€¦           |
| â†³ adjust                    | åŠ¨è¯åŸå½¢                                                  | è°ƒæ•´                       |                     |
| â†³ the mixture number of VMs | åè¯çŸ­è¯­                                                  | Spot ä¸ On-demand å®ä¾‹çš„æ··åˆæ•°é‡ |                     |
| â†³ maximize + satisfy        | å¹¶åˆ—åŠ¨è¯ç»“æ„                                                | å®ç°æœ€å¤§èŠ‚çœï¼ŒåŒæ—¶æ»¡è¶³â€¦â€¦            |                     |
| â†³ the specified SLO         | åè¯çŸ­è¯­                                                  | ç”¨æˆ·è®¾å®šçš„æœåŠ¡æ°´å¹³ç›®æ ‡              |                     |
| â†³ provided by users         | è¿‡å»åˆ†è¯ä½œåç½®å®šè¯­                                             | ç”±ç”¨æˆ·æä¾›                    |                     |

| æˆåˆ†ç±»åˆ« | è‹±æ–‡å†…å®¹                                                                                    | è¯æ€§ / ç»“æ„ | ä¸­æ–‡å«ä¹‰                                            |
| ---- | --------------------------------------------------------------------------------------- | ------- | ----------------------------------------------- |
| è°“è¯­ 1 | implement                                                                               | åŠ¨è¯      | å®ç°ï¼ˆéƒ¨ç½²ï¼‰äº†                                         |
| å®¾è¯­   | an example VM scaling group under the framework of Snape                                | åè¯çŸ­è¯­    | åœ¨ Snape æ¡†æ¶ä¸‹çš„ä¸€ä¸ªç¤ºä¾‹è™šæ‹Ÿæœºæ‰©å±•ç»„                          |
| è°“è¯­ 2 | validate                                                                                | åŠ¨è¯      | éªŒè¯äº†                                             |
| å®¾è¯­   | its effectiveness in experiments                                                        | åè¯çŸ­è¯­    | å®ƒåœ¨å®éªŒä¸­çš„æœ‰æ•ˆæ€§                                       |
| å®¾è¯­ä»å¥ | that Snape achieves 44% savings than on-demand VMSG while retaining 99.96% availability | åè¯æ€§ä»å¥   | Snape ç›¸è¾ƒäºçº¯ On-demand VMSG èŠ‚çœ 44%ï¼Œä»ä¿ç•™ 99.96% å¯ç”¨æ€§ |

---
2 BACKGROUND 
2.1 VM Scaling Groups
VM Scaling Group (VMSG) has been offered by all major cloud providers though under different names, namely, AWS ASG, GCP MIG, and Azure VMSS.
A scaling group consists of a group of VMs managed by an autoscaler based on a specific rule (e.g., a predefined schedule) or target metrics such as CPU utilization, request per second, or predicted workload.
è™šæ‹Ÿæœºæ‰©å±•ç»„ï¼ˆVMSGï¼‰å·²ç»è¢«æ‰€æœ‰ä¸»æµäº‘æœåŠ¡æä¾›å•†æä¾›ï¼Œå°½ç®¡åç§°ä¸åŒï¼Œä¾‹å¦‚ AWS çš„ ASGã€GCP çš„ MIG å’Œ Azure çš„ VMSSã€‚  
ä¸€ä¸ªæ‰©å±•ç»„ç”±ä¸€ç»„è™šæ‹Ÿæœºç»„æˆï¼Œè¿™äº›è™šæ‹Ÿæœºç”±è‡ªåŠ¨æ‰©å±•å™¨ï¼ˆautoscalerï¼‰ç®¡ç†ï¼Œè¯¥ç®¡ç†å¯ä»¥åŸºäºæŸäº›è§„åˆ™ï¼ˆä¾‹å¦‚é¢„å®šä¹‰çš„è°ƒåº¦ï¼‰æˆ–æŸäº›ç›®æ ‡æŒ‡æ ‡ï¼ˆå¦‚ CPU ä½¿ç”¨ç‡ã€æ¯ç§’è¯·æ±‚æ•°æˆ–é¢„æµ‹è´Ÿè½½ï¼‰æ¥è¿›è¡Œã€‚

| **æˆåˆ†ç±»åˆ«**                      | **è‹±æ–‡å†…å®¹**                                   | **è¯æ€§ / ç»“æ„**            | **ä¸­æ–‡å«ä¹‰**                              |
| ----------------------------- | ------------------------------------------ | ---------------------- | ------------------------------------- |
| ä¸»è¯­                            | VM Scaling Group (VMSG)                    | åè¯çŸ­è¯­                   | è™šæ‹Ÿæœºæ‰©å±•ç»„ï¼ˆVMSGï¼‰                          |
| è°“è¯­                            | has been offered                           | ç°åœ¨å®Œæˆæ—¶è¢«åŠ¨è¯­æ€              | å·²è¢«æä¾›                                  |
| æ–½äº‹è¡¥å……                          | by all major cloud providers               | ä»‹è¯çŸ­è¯­                   | ç”±æ‰€æœ‰ä¸»è¦äº‘æœåŠ¡æä¾›å•†                           |
| è®©æ­¥çŠ¶è¯­                          | though under different names               | ä»‹è¯çŸ­è¯­                   | å°½ç®¡åç§°ä¸åŒ                                |
| â†³ under different names       | ä»‹è¯çŸ­è¯­                                       | ä»¥ä¸åŒçš„åç§°ï¼ˆå­˜åœ¨ï¼‰             |                                       |
| ä¸¾ä¾‹è¯´æ˜                          | namely, AWS ASG, GCP MIG, and Azure VMSS   | æ’å…¥è¯­ / åˆ—ä¸¾è¯´æ˜             | å³ï¼šAWS çš„ ASGã€GCP çš„ MIG ä»¥åŠ Azure çš„ VMSS |
| ä¸»è¯­                            | A scaling group                            | åè¯çŸ­è¯­                   | ä¸€ä¸ªæ‰©å±•ç»„ï¼ˆScaling Groupï¼‰                  |
| è°“è¯­                            | consists of                                | ç³»åŠ¨è¯ + ä»‹è¯çŸ­è¯­             | ç”±â€¦â€¦ç»„æˆ                                 |
| å®¾è¯­                            | a group of VMs managed by an autoscaler    | åè¯çŸ­è¯­ + åˆ†è¯çŸ­è¯­            | ä¸€ç»„ç”±è‡ªåŠ¨æ‰©å±•å™¨ç®¡ç†çš„è™šæ‹Ÿæœº                        |
| â†³ managed by...               | è¿‡å»åˆ†è¯çŸ­è¯­ï¼ˆä¿®é¥° VMsï¼‰                             | è¢«â€¦â€¦ç®¡ç†çš„ï¼ˆè¢«åŠ¨ï¼‰             |                                       |
| æ¡ä»¶çŠ¶è¯­                          | based on a specific rule or target metrics | åˆ†è¯ç»“æ„                   | åŸºäºç‰¹å®šè§„åˆ™æˆ–ç›®æ ‡æŒ‡æ ‡                           |
| â†³ e.g., a predefined schedule | ä¸¾ä¾‹è¯´æ˜                                       | ä¾‹å¦‚é¢„å®šä¹‰æ—¶é—´è¡¨               |                                       |
| â†³ such as...                  | ä¸¾ä¾‹è¯´æ˜                                       | æ¯”å¦‚ CPU åˆ©ç”¨ç‡ã€æ¯ç§’è¯·æ±‚æ•°ã€æˆ–é¢„æµ‹è´Ÿè½½ |                                       |

In its early days, a VMSG was typically composed of homogeneous VMs, i.e., with the same SKU size and in the same mode (spot or on-demand). 
åœ¨å…¶æ—©æœŸé˜¶æ®µï¼Œè™šæ‹Ÿæœºæ‰©å±•ç»„ï¼ˆVMSGï¼‰é€šå¸¸ç”±åŒæ„çš„è™šæ‹Ÿæœºæ„æˆï¼Œå³å…·æœ‰ç›¸åŒçš„ SKU è§„æ ¼å¹¶è¿è¡Œåœ¨ç›¸åŒæ¨¡å¼ï¼ˆspot æˆ– on-demandï¼‰ä¸‹ã€‚

Recently, clouds (e.g., Azure and AWS) introduced mixed VMSGs which can flexibly orchestrate VMs of different sizes and modes. 
The goal is to benefit from the discount brought by spot instances while fulfilling the basic resource requirement with the on-demand instances.
è¿‘å¹´æ¥ï¼Œäº‘æœåŠ¡æä¾›å•†ï¼ˆå¦‚ Azure å’Œ AWSï¼‰å¼•å…¥äº†æ··åˆå‹ VMSGï¼Œå¯ä»¥çµæ´»ç¼–æ’ä¸åŒå¤§å°å’Œæ¨¡å¼çš„è™šæ‹Ÿæœºã€‚
å…¶ç›®æ ‡æ˜¯ï¼šåœ¨ä½¿ç”¨æŒ‰éœ€å®ä¾‹æ»¡è¶³åŸºç¡€èµ„æºéœ€æ±‚çš„åŒæ—¶ï¼Œåˆ©ç”¨ spot å®ä¾‹å¸¦æ¥çš„æˆæœ¬æŠ˜æ‰£ã€‚

| **æˆåˆ†ç±»åˆ«**                           | **è‹±æ–‡å†…å®¹**                                                                     | **è¯æ€§ / ç»“æ„**         | **ä¸­æ–‡å«ä¹‰**                        |
| ---------------------------------- | ---------------------------------------------------------------------------- | ------------------- | ------------------------------- |
| æ—¶é—´çŠ¶è¯­                               | In its early days                                                            | ä»‹è¯çŸ­è¯­                | åœ¨å…¶æ—©æœŸé˜¶æ®µ                          |
| ä¸»è¯­                                 | a VMSG                                                                       | åè¯çŸ­è¯­                | ä¸€ä¸ªè™šæ‹Ÿæœºæ‰©å±•ç»„                        |
| ç³»åŠ¨è¯ + è¡¨è¯­ç»“æ„                         | was typically composed of homogeneous VMs                                    | è¢«åŠ¨è¯­æ€ï¼ˆè¿‡å»æ—¶ï¼‰           | é€šå¸¸ç”±åŒè´¨è™šæ‹Ÿæœºæ„æˆ                      |
| å‰¯è¯                                 | typically                                                                    | å‰¯è¯                  | é€šå¸¸                              |
| â†³ homogeneous VMs                  | å½¢å®¹è¯ + åè¯                                                                     | åŒç±»å‹çš„è™šæ‹Ÿæœºï¼ˆé…ç½®ä¸€è‡´ï¼‰       |                                 |
| ä¸¾ä¾‹è¯´æ˜                               | i.e., with the same SKU size and in the same mode                            | æ‹‰ä¸ç¼©å†™ï¼ˆthat isï¼‰+ ä»‹è¯çŸ­è¯­ | å³ï¼šSKU ç›¸åŒã€æ¨¡å¼ç›¸åŒï¼ˆspot æˆ– on-demandï¼‰ |
| æ—¶é—´çŠ¶è¯­                               | Recently                                                                     | å‰¯è¯                  | æœ€è¿‘                              |
| è°“è¯­                                 | introduced                                                                   | åŠ¨è¯ï¼ˆä¸€èˆ¬è¿‡å»æ—¶ï¼‰           | å¼•å…¥äº†                             |
| å®¾è¯­                                 | mixed VMSGs                                                                  | åè¯çŸ­è¯­                | æ··åˆå‹è™šæ‹Ÿæœºæ‰©å±•ç»„                       |
| å®šè¯­ä»å¥ï¼ˆä¿®é¥° VMSGsï¼‰                     | which can flexibly orchestrate VMs of different sizes and modes              | å…³ç³»ä»å¥                | èƒ½å¤Ÿçµæ´»ç¼–æ’ä¸åŒè§„æ ¼ä¸ç±»å‹çš„è™šæ‹Ÿæœº               |
| â†³ flexibly orchestrate             | å‰¯è¯ + åŠ¨è¯                                                                      | çµæ´»åœ°è°ƒåº¦ / ç®¡ç†          |                                 |
| â†³ VMs of different sizes and modes | åè¯ + ä»‹è¯çŸ­è¯­                                                                    | å„ç§è§„æ ¼ä¸ç±»å‹çš„è™šæ‹Ÿæœº         |                                 |
| ä¸»è¯­                                 | The goal                                                                     | åè¯                  | ç›®æ ‡                              |
| ç³»åŠ¨è¯ + ä¸å®šå¼è¡¨è¯­                        | is to benefit from the discount brought by spot instances                    | ç³»åŠ¨è¯ + ä¸å®šå¼           | æ˜¯ä¸ºäº†è·å¾— spot å®ä¾‹å¸¦æ¥çš„æŠ˜æ‰£              |
| â†³ benefit from                     | åŠ¨è¯çŸ­è¯­                                                                         | ä»â€¦â€¦ä¸­è·ç›Š              |                                 |
| â†³ the discount                     | åè¯çŸ­è¯­                                                                         | æŠ˜æ‰£ã€ä¼˜æƒ                |                                 |
| â†³ brought by spot instances        | è¿‡å»åˆ†è¯çŸ­è¯­ï¼ˆä¿®é¥° discountï¼‰                                                          | ç”± Spot å®ä¾‹å¸¦æ¥çš„        |                                 |
| å¹¶åˆ—ä¸å®šå¼                              | while fulfilling the basic resource requirement with the on-demand instances | while + åŠ¨åè¯çŸ­è¯­       | åŒæ—¶ç”±æŒ‰éœ€å®ä¾‹æ»¡è¶³åŸºç¡€èµ„æºéœ€æ±‚                 |

The user is required to configure the number of minimum on-demand instances and the mixture ratio.
The autoscaler is responsible for maintaining the proportion of each VM type.
ç”¨æˆ·éœ€è¦é…ç½®**æœ€å°æŒ‰éœ€å®ä¾‹çš„æ•°é‡**ä»¥åŠ**æ··åˆæ¯”ä¾‹**ã€‚  
è€Œ**è‡ªåŠ¨æ‰©å±•å™¨ï¼ˆautoscalerï¼‰åˆ™è´Ÿè´£ç»´æŒæ¯ç§è™šæ‹Ÿæœºç±»å‹çš„æ¯”ä¾‹**ã€‚

| **æˆåˆ†ç±»åˆ«**                         | **è‹±æ–‡å†…å®¹**                                                        | **è¯æ€§ / ç»“æ„**                | **ä¸­æ–‡å«ä¹‰**          |
| -------------------------------- | --------------------------------------------------------------- | -------------------------- | ----------------- |
| è°“è¯­ç»“æ„ï¼ˆè¢«åŠ¨ï¼‰                         | is required to configure                                        | è¢«åŠ¨è¯­æ€ + ä¸å®šå¼                 | è¢«è¦æ±‚é…ç½®             |
| å®¾è¯­ç»“æ„ï¼ˆå¹¶åˆ—ï¼‰                         | the number of minimum on-demand instances and the mixture ratio | åè¯çŸ­è¯­å¹¶åˆ—ç»“æ„                   | æœ€å°æŒ‰éœ€å®ä¾‹æ•°é‡ä¸æ··åˆæ¯”ä¾‹     |
| â†³ minimum on-demand instances    | åè¯çŸ­è¯­                                                            | æœ€å°æ•°é‡çš„æŒ‰éœ€è™šæ‹Ÿæœº                 |                   |
| â†³ the mixture ratio              | åè¯çŸ­è¯­                                                            | æ··åˆæ¯”ä¾‹ï¼ˆSpot ä¸ On-demand çš„æ¯”ä¾‹ï¼‰ |                   |
| ä¸»è¯­                               | The autoscaler                                                  | åè¯çŸ­è¯­                       | è‡ªåŠ¨æ‰©å±•å™¨ï¼ˆautoscalerï¼‰ |
| ç³»åŠ¨è¯ + è¡¨è¯­ç»“æ„                       | is responsible for                                              | ç³»åŠ¨è¯ + ä»‹è¯çŸ­è¯­                 | è´Ÿè´£â€¦â€¦ï¼ˆå¯¹â€¦â€¦è´Ÿè´£ï¼‰       |
| å®¾è¯­                               | maintaining the proportion of each VM type                      | åŠ¨åè¯çŸ­è¯­                      | ç»´æŒæ¯ç§è™šæ‹Ÿæœºç±»å‹çš„æ¯”ä¾‹      |
| â†³ maintaining                    | åŠ¨åè¯                                                             | ç»´æŒï¼Œä¿æŒ                      |                   |
| â†³ the proportion of each VM type | åè¯çŸ­è¯­                                                            | æ¯ç§è™šæ‹Ÿæœºç±»å‹çš„æ¯”ä¾‹                 |                   |

For example, if the minimum number of on-demand instances is 4 and the mixture ratio is 0.5, then when the scaling group size is 10, there are 7 on-demand instances plus 3 spot instances.
Detailed orchestration behaviors for AWS can be found here.
ä¾‹å¦‚ï¼Œå¦‚æœæœ€å°æŒ‰éœ€å®ä¾‹æ•°é‡ä¸º 4ï¼Œæ··åˆæ¯”ä¾‹ä¸º 0.5ï¼Œ  
é‚£ä¹ˆå½“æ‰©å±•ç»„çš„æ€»å¤§å°ä¸º 10 æ—¶ï¼Œå°†åŒ…å« 7 ä¸ªæŒ‰éœ€å®ä¾‹ä¸ 3 ä¸ª Spot å®ä¾‹ã€‚
æœ‰å…³ AWS çš„è¯¦ç»†ç¼–æ’è¡Œä¸ºï¼Œè¯·å‚è€ƒæ­¤å¤„ã€‚

| **æˆåˆ†ç±»åˆ«**                   | **è‹±æ–‡å†…å®¹**                                              | **è¯æ€§ / ç»“æ„**        | **ä¸­æ–‡å«ä¹‰**                |
| -------------------------- | ----------------------------------------------------- | ------------------ | ----------------------- |
| â†³ the minimum number of... | åè¯çŸ­è¯­                                                  | æœ€å°æ•°é‡çš„â€¦â€¦ï¼ˆæŒ‰éœ€è™šæ‹Ÿæœºï¼‰     |                         |
| å¹¶åˆ—æ¡ä»¶çŠ¶è¯­ä»å¥ 2                 | and the mixture ratio is 0.5                          | å¹¶åˆ—ç»“æ„               | ä¸”æ··åˆæ¯”ä¾‹ä¸º 0.5              |
| â†³ the mixture ratio        | åè¯çŸ­è¯­                                                  | æ··åˆæ¯”ä¾‹               |                         |
| ä¸»å¥ä¸»è¯­                       | then when the scaling group size is 10,               | æ—¶é—´çŠ¶è¯­ä»å¥ + then      | é‚£ä¹ˆå½“æ‰©å±•ç»„å¤§å°ä¸º 10 æ—¶          |
| â†³ the scaling group size   | åè¯çŸ­è¯­                                                  | æ‰©å±•ç»„çš„æ€» VM æ•°é‡        |                         |
| ä¸»å¥è°“è¯­                       | there are 7 on-demand instances plus 3 spot instances | å­˜åœ¨å¥ç»“æ„ + æ•°é‡         | æœ‰ 7 ä¸ªæŒ‰éœ€å®ä¾‹ + 3 ä¸ª spot å®ä¾‹ |
| ä¸»è¯­                         | Detailed orchestration behaviors for AWS              | åè¯çŸ­è¯­               | AWS çš„è¯¦ç»†ç¼–æ’è¡Œä¸º             |
| è°“è¯­ï¼ˆè¢«åŠ¨è¯­æ€ï¼‰                   | can be found                                          | æƒ…æ€åŠ¨è¯ + è¢«åŠ¨è¯­æ€        | å¯ä»¥è¢«æ‰¾åˆ°                   |


For spot instance evictions, we notice that the auto-restoration is supported, which means that the autoscaler will automatically restart the evicted spot instances if capacity permits. 
However, this is not guaranteed especially during peak hours due to constrained capacity. We studied the spot VM auto-restoration which will be detailed in Section 3.2.
æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼ŒSpot å®ä¾‹è¢«é©±é€åï¼Œæ”¯æŒè‡ªåŠ¨æ¢å¤åŠŸèƒ½ï¼Œ
è¿™æ„å‘³ç€å¦‚æœå®¹é‡å…è®¸ï¼Œè‡ªåŠ¨æ‰©å±•å™¨å°†ä¼šè‡ªåŠ¨é‡å¯è¢«é©±é€çš„ Spot å®ä¾‹ã€‚
ç„¶è€Œï¼Œè¿™ä¸€è¡Œä¸ºå¹¶ä¸æ€»æ˜¯æœ‰ä¿éšœçš„ï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜å³°æ—¶æ®µï¼Œç”±äºå®¹é‡é™åˆ¶ï¼Œå¯èƒ½æ— æ³•è¿›è¡Œæ¢å¤ã€‚
æˆ‘ä»¬ç ”ç©¶äº†è¯¥è‡ªåŠ¨æ¢å¤æœºåˆ¶ï¼Œå¹¶å°†åœ¨ç¬¬ 3.2 èŠ‚ä¸­è¯¦ç»†è¯´æ˜ã€‚

| **æˆåˆ†ç±»åˆ«**                                       | **è‹±æ–‡å†…å®¹**                                | **è¯æ€§ / ç»“æ„**        | **ä¸­æ–‡å«ä¹‰**        |
| ---------------------------------------------- | --------------------------------------- | ------------------ | --------------- |
| ä»‹è¯çŸ­è¯­ï¼ˆå¼•å‡ºè¯é¢˜ï¼‰                                     | For spot instance evictions             | ä»‹è¯çŸ­è¯­               | å¯¹äº Spot å®ä¾‹çš„å›æ”¶äº‹ä»¶ |
| è°“è¯­                                             | notice                                  | åŠ¨è¯                 | æ³¨æ„åˆ°ï¼Œè§‚å¯Ÿåˆ°         |
| å®¾è¯­ä»å¥                                           | that the auto-restoration is supported  | åè¯æ€§ä»å¥              | è‡ªåŠ¨æ¢å¤åŠŸèƒ½æ˜¯è¢«æ”¯æŒçš„     |
| â†³ the auto-restoration                         | åè¯çŸ­è¯­                                    | Spot å®ä¾‹è¢«é©±é€åçš„è‡ªåŠ¨æ¢å¤   |                 |
| â†³ is supported                                 | è¢«åŠ¨è¯­æ€                                    | æ˜¯è¢«æ”¯æŒçš„              |                 |
| å®šè¯­ä»å¥ï¼ˆè¡¥å……è¯´æ˜ï¼‰                                     | which means that the autoscaler will... | å…³ç³»ä»å¥               | ä¹Ÿå°±æ˜¯è¯´è‡ªåŠ¨æ‰©å±•å™¨å°†â€¦â€¦    |
| â†³ the autoscaler will automatically restart... | ä¸»è¯­ + æƒ…æ€åŠ¨è¯ + å‰¯è¯ + åŠ¨è¯                     | autoscaler å°†è‡ªåŠ¨é‡å¯â€¦â€¦ |                 |
| â†³ the evicted spot instances                   | åè¯çŸ­è¯­                                    | è¢«é©±é€çš„ Spot å®ä¾‹       |                 |
| â†³ if capacity permits                          | æ¡ä»¶çŠ¶è¯­ä»å¥                                  | å¦‚æœå®¹é‡å…è®¸             |                 |
| è½¬æŠ˜å‰¯è¯                                           | However                                 | å‰¯è¯                 | ç„¶è€Œ              |
| è°“è¯­                                             | is not guaranteed                       | ç³»åŠ¨è¯ + å¦å®š + è¿‡å»åˆ†è¯    | æ— æ³•ä¿è¯            |
| æ—¶é—´çŠ¶è¯­                                           | especially during peak hours            | å‰¯è¯ + ä»‹è¯çŸ­è¯­          | å°¤å…¶æ˜¯åœ¨é«˜å³°æœŸ         |
| åŸå› çŠ¶è¯­                                           | due to constrained capacity             | ä»‹è¯çŸ­è¯­               | ç”±äºå®¹é‡å—é™          |
| è°“è¯­                                             | studied                                 | åŠ¨è¯                 | ç ”ç©¶äº†             |
| å®¾è¯­                                             | the spot VM auto-restoration            | åè¯çŸ­è¯­               | Spot VM çš„è‡ªåŠ¨æ¢å¤æœºåˆ¶ |
| å®šè¯­ä»å¥                                           | which will be detailed in Section 3.2   | å…³ç³»ä»å¥               | å®ƒå°†åœ¨ç¬¬ 3.2 èŠ‚ä¸­è¯¦ç»†è¯´æ˜ |

Third-party orchestrators also exist such as AutoSpotting which greedily allocates spot instances to fulfill the required number of VMs.
When spot instances get evicted, it immediately allocates on-demand instances to ensure the required capacity.
ä¾‹å¦‚ AutoSpottingç­‰ç¬¬ä¸‰æ–¹è°ƒåº¦å™¨ä¹Ÿå­˜åœ¨ï¼Œå®ƒä¼šè´ªå©ªåœ°åˆ†é… Spot å®ä¾‹ä»¥æ»¡è¶³æ‰€éœ€çš„ VM æ•°é‡ã€‚
å½“ Spot å®ä¾‹è¢«å›æ”¶æ—¶ï¼Œå®ƒä¼šç«‹å³åˆ†é… On-demand å®ä¾‹æ¥ä¿éšœå®¹é‡ã€‚

| **æˆåˆ†ç±»åˆ«**             | **è‹±æ–‡å†…å®¹**                                                                      | **è¯æ€§ / ç»“æ„**           | **ä¸­æ–‡å«ä¹‰**                     |
| -------------------- | ----------------------------------------------------------------------------- | --------------------- | ---------------------------- |
| ä¸»è¯­                   | Third-party orchestrators                                                     | åè¯çŸ­è¯­                  | ç¬¬ä¸‰æ–¹è°ƒåº¦å™¨                       |
| è°“è¯­                   | also exist                                                                    | å‰¯è¯ + åŠ¨è¯               | ä¹Ÿå­˜åœ¨                          |
| ä¸¾ä¾‹æ’å…¥è¯­                | such as AutoSpotting                                                          | æ’å…¥è¯­ï¼ˆåˆ—ä¸¾ï¼‰               | ä¾‹å¦‚ AutoSpottingï¼ˆæ–‡çŒ® [6]ï¼‰      |
| å®šè¯­ä»å¥                 | which greedily allocates spot instances to fulfill the required number of VMs | å…³ç³»ä»å¥ï¼ˆä¿®é¥° AutoSpottingï¼‰ | å®ƒä¼šè´ªå©ªåœ°åˆ†é… spot å®ä¾‹ä»¥æ»¡è¶³æ‰€éœ€ VM æ•°é‡   |
| â†³ greedily allocates | å‰¯è¯ + åŠ¨è¯                                                                       | è´ªå©ªåœ°åˆ†é…ï¼ˆä¼˜å…ˆ spot å®ä¾‹ï¼‰     |                              |
| â†³ to fulfill...      | ä¸å®šå¼ä½œç›®çš„çŠ¶è¯­                                                                      | ä¸ºäº†æ»¡è¶³â€¦â€¦                |                              |
| **æˆåˆ†ç±»åˆ«**             | **è‹±æ–‡å†…å®¹**                                                                      | **è¯æ€§ / ç»“æ„**           | **ä¸­æ–‡å«ä¹‰**                     |
| æ—¶é—´çŠ¶è¯­ä»å¥               | When spot instances get evicted                                               | æ—¶é—´çŠ¶è¯­ä»å¥                | å½“ spot å®ä¾‹è¢«é©±é€æ—¶                |
| ä¸»è¯­                   | it (æŒ‡ AutoSpotting)                                                           | ä»£è¯                    | å®ƒï¼ˆAutoSpottingï¼‰              |
| è°“è¯­                   | immediately allocates on-demand instances                                     | å‰¯è¯ + åŠ¨è¯ + å®¾è¯­          | ç«‹å³åˆ†é…æŒ‰éœ€å®ä¾‹                     |
| ç›®çš„çŠ¶è¯­                 | to ensure the required capacity                                               | ä¸å®šå¼çŸ­è¯­                 | ä¸ºäº†ç¡®ä¿æ‰€éœ€å®¹é‡                     |

Then, when the spot instances are restored, AutoSpotting will shut down the on-demand instances.
There is no explicit SLO for VMSG and only instance-level SLO for on-demand VMs now.
We thus define the SLO of a VMSG as an extension of the instance-level SLO, which will be discussed in Section 3.2.
ä¹‹åï¼Œä¸€æ—¦ Spot å®ä¾‹æ¢å¤ï¼ŒAutoSpotting ä¼šå…³é—­é‚£äº›æŒ‰éœ€å®ä¾‹ã€‚
ç›®å‰ï¼ŒVMSG å¹¶æ²¡æœ‰æ˜¾å¼çš„ SLO è§„å®šï¼Œè€Œåªæœ‰é€‚ç”¨äºæŒ‰éœ€ VM çš„å®ä¾‹çº§åˆ« SLOã€‚
å› æ­¤ï¼Œæˆ‘ä»¬å°† VMSG çš„ SLO å®šä¹‰ä¸ºå®ä¾‹çº§åˆ« SLO çš„æ‰©å±•ï¼Œå¹¶å°†åœ¨ 3.2 èŠ‚ä¸­è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚


| **æˆåˆ†ç±»åˆ«**             | **è‹±æ–‡å†…å®¹**                                                                      | **è¯æ€§ / ç»“æ„**           | **ä¸­æ–‡å«ä¹‰**                     |
| -------------------- | ----------------------------------------------------------------------------- | --------------------- | ---------------------------- |
| æ—¶é—´çŠ¶è¯­ä»å¥               | when the spot instances are restored                                          | æ—¶é—´çŠ¶è¯­ä»å¥                | å½“ spot å®ä¾‹æ¢å¤å                 |
| ä¸»å¥å‰¯è¯                 | Then                                                                          | æ—¶é—´å‰¯è¯                  | ç„¶å                           |
| ä¸»è¯­                   | AutoSpotting                                                                  | ä¸“æœ‰åè¯                  | AutoSpotting ç³»ç»Ÿ              |
| è°“è¯­                   | will shut down the on-demand instances                                        | æƒ…æ€åŠ¨è¯ + åŠ¨è¯çŸ­è¯­           | å°†å…³é—­æŒ‰éœ€å®ä¾‹                      |
| **æˆåˆ†ç±»åˆ«**             | **è‹±æ–‡å†…å®¹**                                                                      | **è¯æ€§ / ç»“æ„**           | **ä¸­æ–‡å«ä¹‰**                     |
| ä¸»å¥                   | There is no explicit SLO for VMSG                                             | å­˜åœ¨å¥ç»“æ„                 | VMSG ç›®å‰æ²¡æœ‰æ˜ç¡®çš„ SLO             |
| å¹¶åˆ—ç»“æ„                 | and only instance-level SLO for on-demand VMs now                             | å¹¶åˆ—å¥                   | ç›®å‰åªæœ‰é€‚ç”¨äºæŒ‰éœ€ VM çš„å®ä¾‹çº§åˆ« SLO       |
| **æˆåˆ†ç±»åˆ«**             | **è‹±æ–‡å†…å®¹**                                                                      | **è¯æ€§ / ç»“æ„**           | **ä¸­æ–‡å«ä¹‰**                     |
| ä¸»è¯­                   | We                                                                            | ä¸»æ ¼ä»£è¯                  | æˆ‘ä»¬                           |
| å‰¯è¯                   | thus                                                                          | å‰¯è¯                    | å› æ­¤                           |
| è°“è¯­ç»“æ„                 | define the SLO of a VMSG as an extension of the instance-level SLO            | åŠ¨è¯ + å®¾è¯­ + ä»‹è¯çŸ­è¯­        | å°† VMSG çš„ SLO å®šä¹‰ä¸ºå®ä¾‹çº§åˆ« SLO çš„æ‰©å±• |
| å®šè¯­ä»å¥                 | which will be discussed in Section 3.2                                        | å…³ç³»ä»å¥                  | å®ƒå°†åœ¨ç¬¬ 3.2 èŠ‚è¯¦ç»†è®¨è®º               |

2.2 Constrained Reinforcement Learning
Constrained Reinforcement Learning (CRL) is a kind of Reinforcement Learning algorithm whose goal is not only to maximize long-term cumulative reward but also to satisfy the additional constraints without any heuristics or rules.
å—é™å¼ºåŒ–å­¦ä¹ ï¼ˆCRLï¼‰æ˜¯ä¸€ç§å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œå®ƒçš„ç›®æ ‡ä¸ä»…æ˜¯æœ€å¤§åŒ–é•¿æœŸç´¯ç§¯å¥–åŠ±ï¼Œ
è€Œä¸”è¿˜è¦åœ¨æ²¡æœ‰ä»»ä½•å¯å‘å¼æˆ–è§„åˆ™çš„æƒ…å†µä¸‹æ»¡è¶³é™„åŠ çº¦æŸæ¡ä»¶ã€‚

|**æˆåˆ†ç±»åˆ«**|**è‹±æ–‡å†…å®¹**|**è¯æ€§ / ç»“æ„**|**ä¸­æ–‡å«ä¹‰**|
|---|---|---|---|
|ä¸»è¯­|Constrained Reinforcement Learning (CRL)|åè¯çŸ­è¯­|å—é™å¼ºåŒ–å­¦ä¹ ï¼ˆCRLï¼‰|
|ç³»åŠ¨è¯ + è¡¨è¯­|is a kind of Reinforcement Learning algorithm|ç³»åŠ¨è¯ + åè¯çŸ­è¯­|æ˜¯ä¸€ç§å¼ºåŒ–å­¦ä¹ ç®—æ³•|
|â†³ a kind of|åè¯çŸ­è¯­ï¼ˆåˆ†ç±»ç»“æ„ï¼‰|ä¸€ç§â€¦â€¦çš„ç±»å‹||
|â†³ Reinforcement Learning algorithm|åè¯çŸ­è¯­|å¼ºåŒ–å­¦ä¹ ç®—æ³•||
|å®šè¯­ä»å¥|whose goal is not only to maximize long-term cumulative reward...|å…³ç³»ä»å¥ï¼ˆä¿®é¥° algorithmï¼‰|å…¶ç›®æ ‡ä¸ä»…æ˜¯æœ€å¤§åŒ–é•¿æœŸç´¯ç§¯å¥–åŠ±â€¦â€¦|
|â†³ whose|å…³ç³»ä»£è¯ï¼Œä½œå®šè¯­|å®ƒçš„ï¼ˆæŒ‡ä»£ algorithm çš„ï¼‰||
|â†³ goal is â€¦|ä¸»ç³»è¡¨ç»“æ„|ç›®æ ‡æ˜¯â€¦â€¦||
|â†³ not only A but also B|å¹¶åˆ—ç»“æ„|ä¸ä»… A è€Œä¸” Bï¼ˆA å’Œ B ä¸ºåŠ¨è¯ä¸å®šå¼ï¼‰||
|A æˆåˆ†|to maximize long-term cumulative reward|ä¸å®šå¼çŸ­è¯­|æœ€å¤§åŒ–é•¿æœŸç´¯è®¡å¥–åŠ±|
|B æˆåˆ†|to satisfy the additional constraints|ä¸å®šå¼çŸ­è¯­|æ»¡è¶³é¢å¤–çº¦æŸæ¡ä»¶|
|æ–¹å¼çŠ¶è¯­|without any heuristics or rules|ä»‹è¯çŸ­è¯­|æ— éœ€ä»»ä½•å¯å‘å¼è§„åˆ™ï¼ˆå³ä¸é æ‰‹å·¥ç»éªŒè§„åˆ™ï¼‰|

CRL is a key field for real-world RL problems as ensuring the satisfaction of certain constraints is necessary and essential in practice. has seen great success in a variety of industries, including electric grids, networking, robotics, resource allocation, and wireless security. 
å—é™å¼ºåŒ–å­¦ä¹ ï¼ˆCRLï¼‰æ˜¯ç°å®ä¸–ç•Œå¼ºåŒ–å­¦ä¹ é—®é¢˜ä¸­çš„ä¸€ä¸ªå…³é”®é¢†åŸŸï¼Œ  
å› ä¸ºåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç¡®ä¿æ»¡è¶³æŸäº›çº¦æŸæ¡ä»¶æ˜¯å¿…è¦ä¸”è‡³å…³é‡è¦çš„ã€‚  
å®ƒå·²ç»åœ¨å¤šä¸ªè¡Œä¸šä¸­å–å¾—äº†æ˜¾è‘—æˆåŠŸï¼ŒåŒ…æ‹¬ç”µç½‘ã€ç½‘ç»œã€æœºå™¨äººã€èµ„æºåˆ†é…ä»¥åŠæ— çº¿å®‰å…¨ç­‰é¢†åŸŸã€‚

| **æˆåˆ†ç±»åˆ«**                                  | **è‹±æ–‡å†…å®¹**                                                                                   | **è¯æ€§ / ç»“æ„**            | **ä¸­æ–‡å«ä¹‰**                                   |
| ----------------------------------------- | ------------------------------------------------------------------------------------------ | ---------------------- | ------------------------------------------ |
| ä¸»è¯­                                        | CRL                                                                                        | ä¸“æœ‰åè¯ï¼ˆç¼©å†™ï¼‰               | å—é™å¼ºåŒ–å­¦ä¹ ï¼ˆConstrained Reinforcement Learningï¼‰ |
| ç³»åŠ¨è¯ + è¡¨è¯­                                  | is a key field                                                                             | ç³»åŠ¨è¯ + åè¯çŸ­è¯­             | æ˜¯ä¸€ä¸ªå…³é”®é¢†åŸŸ                                    |
| åœ°ç‚¹çŠ¶è¯­                                      | for real-world RL problems                                                                 | ä»‹è¯çŸ­è¯­                   | é’ˆå¯¹ç°å®ä¸–ç•Œçš„å¼ºåŒ–å­¦ä¹ é—®é¢˜                              |
| åŸå› çŠ¶è¯­ä»å¥                                    | as ensuring the satisfaction of certain constraints is necessary and essential in practice | as å¼•å¯¼åŸå› çŠ¶è¯­ä»å¥            | å› ä¸ºåœ¨å®è·µä¸­ç¡®ä¿æ»¡è¶³æŸäº›çº¦æŸæ˜¯å¿…è¦ä¸”å…³é”®çš„                      |
| â†³ ensuring ...                            | åŠ¨åè¯çŸ­è¯­                                                                                      | ç¡®ä¿â€¦â€¦                   |                                            |
| â†³ the satisfaction of certain constraints | åè¯çŸ­è¯­                                                                                       | æŸäº›çº¦æŸçš„æ»¡è¶³                |                                            |
| â†³ is necessary and essential in practice  | ç³»åŠ¨è¯ç»“æ„ + å¹¶åˆ—è¡¨è¯­                                                                               | åœ¨å®è·µä¸­æ˜¯å¿…è¦ä¸”å…³é”®çš„            |                                            |
| **æˆåˆ†ç±»åˆ«**                                  | **è‹±æ–‡å†…å®¹**                                                                                   | **è¯æ€§ / ç»“æ„**            | **ä¸­æ–‡å«ä¹‰**                                   |
| ä¸»è¯­ï¼ˆçœç•¥ï¼‰                                    | (It)                                                                                       | ä¸»è¯­ä»£è¯ï¼ˆæŒ‡ä»£ CRLï¼‰           | å®ƒï¼ˆå³ CRLï¼‰                                   |
| è°“è¯­                                        | has seen great success                                                                     | ç°åœ¨å®Œæˆæ—¶ï¼ˆhave/has + p.p.ï¼‰ | å·²ç»å–å¾—äº†å·¨å¤§æˆåŠŸ                                  |
| åœ°ç‚¹çŠ¶è¯­                                      | in a variety of industries                                                                 | ä»‹è¯çŸ­è¯­                   | åœ¨å„ç§è¡Œä¸šä¸­                                     |
| ä¸¾ä¾‹æ’å…¥è¯­                                     | including electric grids, networking, robotics, resource allocation, and wireless security | ç°åœ¨åˆ†è¯çŸ­è¯­ï¼ˆåˆ—ä¸¾ï¼‰             | åŒ…æ‹¬ç”µç½‘ã€ç½‘ç»œã€æœºå™¨äººã€èµ„æºåˆ†é…ä¸æ— çº¿å®‰å…¨ç­‰                     |

Applying CRL to our problem, the objective is to maintain the number of in-service VMs, not dropping below the target number while minimizing the cost of using VMs in the long term.
It is challenging to make such long-term decisions to maintain the target due to the complexity of the system, e.g., the behavior of spot evictions.
å°† CRL åº”ç”¨äºæœ¬é—®é¢˜æ—¶ï¼Œå…¶ç›®æ ‡æ˜¯ç»´æŒè¿è¡Œä¸­çš„è™šæ‹Ÿæœºæ•°é‡ä¸å°‘äºç›®æ ‡å€¼ï¼Œ
åŒæ—¶é•¿æœŸæœ€å°åŒ–è™šæ‹Ÿæœºä½¿ç”¨æˆæœ¬ã€‚
ç„¶è€Œï¼Œè¦åšå‡ºè¿™ç§é•¿æœŸç­–ç•¥å†³ç­–æ¥ç»´æŒç›®æ ‡æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œ
åŸå› åœ¨äºç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œä¾‹å¦‚ Spot å®ä¾‹è¢«å›æ”¶çš„è¡Œä¸ºæ¨¡å¼ã€‚

| **æˆåˆ†ç±»åˆ«**    | **è‹±æ–‡å†…å®¹**                                                | **è¯æ€§ / ç»“æ„**        | **ä¸­æ–‡å«ä¹‰**         |
| ----------- | ------------------------------------------------------- | ------------------ | ---------------- |
| æ–¹å¼çŠ¶è¯­ï¼ˆå¼•å¯¼å¼€å¤´ï¼‰  | Applying CRL to our problem                             | åŠ¨åè¯çŸ­è¯­ï¼ˆå…¨å¥çŠ¶è¯­ï¼‰        | å°† CRL åº”ç”¨äºæˆ‘ä»¬çš„é—®é¢˜   |
| ä¸»è¯­          | the objective                                           | åè¯çŸ­è¯­               | ç›®æ ‡               |
| è¡¨è¯­          | to maintain the number of in-service VMs                | ä¸å®šå¼çŸ­è¯­              | ç»´æŒè¿è¡Œä¸­è™šæ‹Ÿæœºæ•°é‡       |
| é™„åŠ æ¡ä»¶ï¼ˆå¹¶åˆ—ä¸å®šå¼ï¼‰ | not dropping below the target number                    | å¦å®šåŠ¨åè¯çŸ­è¯­            | ä¸ä½äºç›®æ ‡æ•°é‡          |
| å¹¶åˆ—ç›®çš„çŠ¶è¯­      | while minimizing the cost of using VMs in the long term | while å¼•å¯¼çš„æ—¶é—´ / çŠ¶æ€çŠ¶è¯­ | åŒæ—¶é•¿æœŸæœ€å°åŒ–ä½¿ç”¨ VM çš„æˆæœ¬ |
| **æˆåˆ†ç±»åˆ«**    | **è‹±æ–‡å†…å®¹**                                                | **è¯æ€§ / ç»“æ„**        | **ä¸­æ–‡å«ä¹‰**         |
| è¡¨è¯­ï¼ˆå½¢å®¹è¯ï¼‰     | challenging                                             | å½¢å®¹è¯                | æœ‰æŒ‘æˆ˜æ€§çš„            |
| çœŸä¸»è¯­ï¼ˆä¸å®šå¼ï¼‰    | to make such long-term decisions to maintain the target | ä¸å®šå¼ç»“æ„              | åšå‡ºè¿™ç§é•¿æœŸå†³ç­–ä»¥ç»´æŒç›®æ ‡    |
| åŸå› çŠ¶è¯­        | due to the complexity of the system                     | ä»‹è¯çŸ­è¯­               | ç”±äºç³»ç»Ÿçš„å¤æ‚æ€§         |
| ä¾‹å­æ’å…¥è¯­       | e.g., the behavior of spot evictions                    | æ’å…¥è¯­                | ä¾‹å¦‚ï¼šSpot å®ä¾‹å›æ”¶çš„è¡Œä¸º  |

For instance, adding extra spot VMs to VMSG does not guarantee the target number but results in additional costs; conversely, always keeping a certain number of on-demand VMs is unnecessary (as discussed further in Section 5).
ä¾‹å¦‚ï¼Œå‘ VMSG ä¸­æ·»åŠ é¢å¤–çš„ Spot å®ä¾‹è™½ç„¶ä¼šå¢åŠ æ•°é‡ï¼Œ
ä½†å¹¶ä¸èƒ½ä¿è¯è¾¾åˆ°ç›®æ ‡è™šæ‹Ÿæœºæ•°ï¼Œåè€Œä¼šå¸¦æ¥é¢å¤–çš„æˆæœ¬ï¼›
ç›¸ååœ°ï¼Œæ€»æ˜¯ä¿ç•™ä¸€å®šæ•°é‡çš„æŒ‰éœ€å®ä¾‹ä¹Ÿæ²¡æœ‰å¿…è¦ï¼ˆè¿™ä¸€ç‚¹å°†åœ¨ç¬¬ 5 èŠ‚è¿›ä¸€æ­¥è®¨è®ºï¼‰ã€‚

| **æˆåˆ†ç±»åˆ«**    | **è‹±æ–‡å†…å®¹**                                         | **è¯æ€§ / ç»“æ„**     | **ä¸­æ–‡å«ä¹‰**             |
| ----------- | ------------------------------------------------ | --------------- | -------------------- |
| ä¸¾ä¾‹å‰¯è¯ï¼ˆå¥é¦–æ’å…¥è¯­ï¼‰ | For instance                                     | å‰¯è¯çŸ­è¯­            | ä¾‹å¦‚                   |
| ä¸»è¯­          | adding extra spot VMs to VMSG                    | åŠ¨åè¯çŸ­è¯­           | å°†é¢å¤–çš„ spot å®ä¾‹æ·»åŠ åˆ° VMSG |
| è°“è¯­ 1        | does not guarantee the target number             | åŠ©åŠ¨è¯ + å¦å®š + åŠ¨è¯çŸ­è¯­ | å¹¶ä¸èƒ½ä¿è¯è¾¾åˆ°ç›®æ ‡æ•°é‡          |
| å¹¶åˆ—è°“è¯­        | but results in additional costs                  | å¹¶åˆ—åŠ¨è¯ç»“æ„          | è€Œæ˜¯ä¼šå¯¼è‡´é¢å¤–æˆæœ¬            |
| **æˆåˆ†ç±»åˆ«**    | **è‹±æ–‡å†…å®¹**                                         | **è¯æ€§ / ç»“æ„**     | **ä¸­æ–‡å«ä¹‰**             |
| è½¬æŠ˜å‰¯è¯ï¼ˆå¥é¦–ï¼‰    | conversely                                       | å‰¯è¯              | ç›¸ååœ°                  |
| ä¸»è¯­          | always keeping a certain number of on-demand VMs | åŠ¨åè¯ç»“æ„           | æ€»æ˜¯ä¿ç•™ä¸€å®šæ•°é‡çš„æŒ‰éœ€å®ä¾‹        |
| ç³»åŠ¨è¯ + è¡¨è¯­    | is unnecessary                                   | ç³»åŠ¨è¯ + å½¢å®¹è¯       | æ˜¯æ²¡æœ‰å¿…è¦çš„               |
| æ’å…¥è¡¥å……è¯´æ˜      | (as discussed further in Section 5)              | æ‹¬å·æ’å…¥è¯­           | å¦‚ç¬¬ 5 èŠ‚å°†è¿›ä¸€æ­¥è®¨è®º         |